<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FreeNOS: lib/libfs/FileSystem.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FreeNOS
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_195cdf951d1d13a1dcd9e3976a834d83.html">libfs</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">FileSystem.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="FileSystem_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright (C) 2015 Niek Linnenbank</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * </span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * This program is free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * it under the terms of the GNU General Public License as published by</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * the Free Software Foundation, either version 3 of the License, or</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * (at your option) any later version.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * This program is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * GNU General Public License for more details.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;FreeNOS/System.h&gt;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="Vector_8h.html">Vector.h</a>&gt;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="HashTable_8h.html">HashTable.h</a>&gt;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="HashIterator_8h.html">HashIterator.h</a>&gt;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="Runtime_8h.html">Runtime.h</a>&gt;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="fcntl_8h.html">fcntl.h</a>&gt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="unistd_8h.html">unistd.h</a>&gt;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="stat_8h.html">sys/stat.h</a>&gt;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="FileSystem_8h.html">FileSystem.h</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="classFileSystem.html#a4875efdffaf91fb7a83d13ea0a57a29a">   28</a></span>&#160;<a class="code" href="classFileSystem.html#a4875efdffaf91fb7a83d13ea0a57a29a">FileSystem::FileSystem</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *path)</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    : <a class="code" href="classChannelServer.html">ChannelServer</a>&lt;<a class="code" href="classFileSystem.html">FileSystem</a>, <a class="code" href="structFileSystemMessage.html">FileSystemMessage</a>&gt;(this)</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;{</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="comment">// Set members</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="classFileSystem.html#ad3936cf61585445c95a04bc3f3c61dbc">m_root</a>      = 0;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="classFileSystem.html#ab3b50b840424b97f09c4b852441be98f">m_mountPath</a> = path;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <a class="code" href="classFileSystem.html#a28244f36400696951221689324d4ff26">m_requests</a>  = <span class="keyword">new</span> <a class="code" href="classList.html">List&lt;FileSystemRequest *&gt;</a>();</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        </div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="comment">// Register message handlers</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="classChannelServer.html#a8a2abcf4992a5431dea74e4321f2da9c">addIPCHandler</a>(<a class="code" href="classCreateFile.html">CreateFile</a>, &amp;<a class="code" href="classFileSystem.html#af4d56f27e3048e630b4cdf9f9cd46fcf">FileSystem::pathHandler</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="classChannelServer.html#a8a2abcf4992a5431dea74e4321f2da9c">addIPCHandler</a>(<a class="code" href="group__libfs.html#gga48a52b001384d627326e5728208bbf96ac6e76230ddc02752cf04f3505f60a387">StatFile</a>,   &amp;<a class="code" href="classFileSystem.html#af4d56f27e3048e630b4cdf9f9cd46fcf">FileSystem::pathHandler</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="classChannelServer.html#a8a2abcf4992a5431dea74e4321f2da9c">addIPCHandler</a>(<a class="code" href="group__libfs.html#gga48a52b001384d627326e5728208bbf96a57479680371066393b8b4fdd05ab5600">DeleteFile</a>, &amp;<a class="code" href="classFileSystem.html#af4d56f27e3048e630b4cdf9f9cd46fcf">FileSystem::pathHandler</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="classChannelServer.html#a8a2abcf4992a5431dea74e4321f2da9c">addIPCHandler</a>(<a class="code" href="group__libfs.html#gga48a52b001384d627326e5728208bbf96a9980b102b1318893a80e5095fa02668c">ReadFile</a>,   &amp;<a class="code" href="classFileSystem.html#af4d56f27e3048e630b4cdf9f9cd46fcf">FileSystem::pathHandler</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="classChannelServer.html#a8a2abcf4992a5431dea74e4321f2da9c">addIPCHandler</a>(<a class="code" href="group__libfs.html#gga48a52b001384d627326e5728208bbf96a8ddf187149fd74f4224ddb3c25716793">WriteFile</a>,  &amp;<a class="code" href="classFileSystem.html#af4d56f27e3048e630b4cdf9f9cd46fcf">FileSystem::pathHandler</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;}</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="classFileSystem.html#a9e366f036e9d9cd884fa689963aacc49">   44</a></span>&#160;<a class="code" href="classFileSystem.html#a9e366f036e9d9cd884fa689963aacc49">FileSystem::~FileSystem</a>()</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;{</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classFileSystem.html#a28244f36400696951221689324d4ff26">m_requests</a>)</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="keyword">delete</span> <a class="code" href="classFileSystem.html#a28244f36400696951221689324d4ff26">m_requests</a>;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;}</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="classFileSystem.html#abbcf90e56a0063b6ce287d5198fd65d2">   50</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="classFileSystem.html#abbcf90e56a0063b6ce287d5198fd65d2">FileSystem::getMountPath</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classFileSystem.html#ab3b50b840424b97f09c4b852441be98f">m_mountPath</a>;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;}</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="classFileSystem.html#a872b5c352670f94ad02984882b436ec2">   55</a></span>&#160;<a class="code" href="classDirectory.html">Directory</a> * <a class="code" href="classFileSystem.html#a872b5c352670f94ad02984882b436ec2">FileSystem::getRoot</a>()</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;{</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="classDirectory.html">Directory</a> *) <a class="code" href="classFileSystem.html#ad3936cf61585445c95a04bc3f3c61dbc">m_root</a>-&gt;<a class="code" href="structFileCache.html#ab17a76259eaa5bec47ca572e95c98a86">file</a>;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;}</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="classFileSystem.html#a5aa6054b8d9277cf1fefe87f71fc89cf">   60</a></span>&#160;<a class="code" href="group__libstd.html#ga32561b1ad57f66e2ca93b07d45e9a9ee">Error</a> <a class="code" href="classFileSystem.html#a5aa6054b8d9277cf1fefe87f71fc89cf">FileSystem::mount</a>()</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;{</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="group__libposix.html#ga7b8e33bf8adf23b27d4f08646c1160a2">pid_t</a> pid = <a class="code" href="group__kernelapi.html#ga12fbd36d91338390f4a6742d5014549b">ProcessCtl</a>(<a class="code" href="group__kernelapi.html#ga6233123742aa307f2a5ce737acca67f0">SELF</a>, <a class="code" href="group__kernelapi.html#ggad194eea1ab5db1371e5da2cc4f256a82add0563c60538360bb6cf3df3d39e7ab4">GetPID</a>);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="structFileSystemMount.html">FileSystemMount</a> mnt;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="comment">// The rootfs server and sysfs server have a fixed mount</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">if</span> (pid == <a class="code" href="group__kernelapi.html#ga454bd0719880383528ea39b0771f1010">ROOTFS_PID</a> || pid == <a class="code" href="group__kernelapi.html#ga75af299153b77c625ac783ad539794dc">SYSFS_PID</a>)</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__libposix.html#ga54c5298a76b9c539d23fd647b1df996d">ESUCCESS</a>;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// Fill the mount structure</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    mnt.<a class="code" href="structFileSystemMount.html#acabcaf5283b5928360f2a88b28bc1b91">procID</a> = pid;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    mnt.<a class="code" href="structFileSystemMount.html#ace893c6e5943a4dfdd134bc8d74cd3c0">options</a> = 0;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="group__libposix.html#ga072ac10bfd51fd99aeb5a9ef1b286ee0">strlcpy</a>(mnt.<a class="code" href="structFileSystemMount.html#af32632b6c19c2c3ad98ee66fc8dc4109">path</a>, <a class="code" href="classFileSystem.html#ab3b50b840424b97f09c4b852441be98f">m_mountPath</a>, <a class="code" href="group__libposix.html#gae688d728e1acdfe5988c7db45d6f0166">PATH_MAX</a>);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">// Open the mounts file in SysFS</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordtype">int</span> fd = <a class="code" href="group__libposix.html#ga2533b93d6921573ef2b7b51f6f5773be">open</a>(<span class="stringliteral">&quot;/sys/mounts&quot;</span>, <a class="code" href="group__libposix.html#ga11b644a8526139c4cc1850dac1271ced">O_WRONLY</a>);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">if</span> (fd &lt; 0)</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    {</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <a class="code" href="group__libstd.html#ga435175024ad996b2a45d734fa9eea0e3">ERROR</a>(<span class="stringliteral">&quot;failed to open mount &#39;&quot;</span> &lt;&lt; <a class="code" href="classFileSystem.html#ab3b50b840424b97f09c4b852441be98f">m_mountPath</a> &lt;&lt; <span class="stringliteral">&quot;&#39;: &quot;</span> &lt;&lt; <a class="code" href="group__libposix.html#gaab5144dac9e072c9873087599a994f5c">strerror</a>(<a class="code" href="group__libposix.html#ga58a036bfd8b45901c15535c179e74be6">errno</a>));</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__libposix.html#ga58a036bfd8b45901c15535c179e74be6">errno</a>;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    }</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">// write the mount structure to the SysFS mounts file</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__libposix.html#gac759c3c657671c9979da89ccfc7782aa">write</a>(fd, &amp;mnt, <span class="keyword">sizeof</span>(mnt)) != <span class="keyword">sizeof</span>(mnt))</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    {</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <a class="code" href="group__libstd.html#ga435175024ad996b2a45d734fa9eea0e3">ERROR</a>(<span class="stringliteral">&quot;failed to write mount &#39;&quot;</span> &lt;&lt; <a class="code" href="classFileSystem.html#ab3b50b840424b97f09c4b852441be98f">m_mountPath</a> &lt;&lt; <span class="stringliteral">&quot;&#39;: &quot;</span> &lt;&lt; <a class="code" href="group__libposix.html#gaab5144dac9e072c9873087599a994f5c">strerror</a>(<a class="code" href="group__libposix.html#ga58a036bfd8b45901c15535c179e74be6">errno</a>));</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <a class="code" href="group__libposix.html#ga5254bb8024414512a0efe8168b31dda0">close</a>(fd);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__libposix.html#ga58a036bfd8b45901c15535c179e74be6">errno</a>;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">// Close it</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="group__libposix.html#ga5254bb8024414512a0efe8168b31dda0">close</a>(fd);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">// Done</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__libposix.html#ga54c5298a76b9c539d23fd647b1df996d">ESUCCESS</a>;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;}</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="classFileSystem.html#a7c8b7ae0ac61411fb82f17d132fc0e36">   97</a></span>&#160;<a class="code" href="classFile.html">File</a> * <a class="code" href="classFileSystem.html#a7c8b7ae0ac61411fb82f17d132fc0e36">FileSystem::createFile</a>(<a class="code" href="group__libfs.html#ga2c794c5c13ab4dd7e65bad031dbe41c3">FileType</a> type, <a class="code" href="structDeviceID.html">DeviceID</a> deviceID)</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;{</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="classFile.html">File</a> *) <a class="code" href="group__libstd.html#gac328e551bde3d39b6d7b8cc9e048d941">ZERO</a>;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;}</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="classFileSystem.html#a334300c3435c6ddd0053ee653a5446ae">  102</a></span>&#160;<a class="code" href="group__libstd.html#ga32561b1ad57f66e2ca93b07d45e9a9ee">Error</a> <a class="code" href="classFileSystem.html#a334300c3435c6ddd0053ee653a5446ae">FileSystem::registerFile</a>(<a class="code" href="classFile.html">File</a> *file, <span class="keyword">const</span> <span class="keywordtype">char</span> *path, ...)</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;{</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="stdarg_8h.html#a8c1b94dabde2c11f430bb83e37bdb0a1">va_list</a> args;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="group__libstd.html#ga32561b1ad57f66e2ca93b07d45e9a9ee">Error</a> r;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="stdarg_8h.html#aa0628ab596c3d7e78f5e08c2d98e24da">va_start</a>(args, path);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    r = <a class="code" href="classFileSystem.html#a334300c3435c6ddd0053ee653a5446ae">registerFile</a>(file, path, args);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <a class="code" href="stdarg_8h.html#a823b205416e9129825841b74c3bf8484">va_end</a>(args);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">return</span> r;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;}</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="classFileSystem.html#adeb45b081915c5cd96fd12536699ad5c">  114</a></span>&#160;<a class="code" href="group__libstd.html#ga32561b1ad57f66e2ca93b07d45e9a9ee">Error</a> <a class="code" href="classFileSystem.html#a334300c3435c6ddd0053ee653a5446ae">FileSystem::registerFile</a>(<a class="code" href="classFile.html">File</a> *file, <span class="keyword">const</span> <span class="keywordtype">char</span> *path, <a class="code" href="stdarg_8h.html#a8c1b94dabde2c11f430bb83e37bdb0a1">va_list</a> args)</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;{</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordtype">char</span> buf[<a class="code" href="group__libfs.html#ga306ffcae7edd4e8e4f5779ad8359ee1c">PATHLEN</a>];</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">// Add to the filesystem cache</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <a class="code" href="group__libposix.html#gabef2233b05a7437b010fb9f88987330a">vsnprintf</a>(buf, <span class="keyword">sizeof</span>(buf), path, args);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="classFileSystem.html#a5fa50bab1ae9956dffcb6c92c0fbfd61">insertFileCache</a>(file, path, args);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">// Also add to the parent directory</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="classFileSystemPath.html">FileSystemPath</a> p((<span class="keywordtype">char</span> *)buf);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="classDirectory.html">Directory</a> *parent;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">if</span> (p.<a class="code" href="classFileSystemPath.html#a2e2a8badda0bd8f29e2e28a34d7612a4">parent</a>())</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        parent = (<a class="code" href="classDirectory.html">Directory</a> *) <a class="code" href="classFileSystem.html#a8b2ba788f5a62495fa62a2576f49c821">findFileCache</a>(**p.<a class="code" href="classFileSystemPath.html#a2e2a8badda0bd8f29e2e28a34d7612a4">parent</a>())-&gt;file;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        parent = (<a class="code" href="classDirectory.html">Directory</a> *) <a class="code" href="classFileSystem.html#ad3936cf61585445c95a04bc3f3c61dbc">m_root</a>-&gt;<a class="code" href="structFileCache.html#ab17a76259eaa5bec47ca572e95c98a86">file</a>;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    parent-&gt;insert(file-&gt;<a class="code" href="classFile.html#aeeb18ed1a35f572f93d337ccb842e5fe">getType</a>(), **p.<a class="code" href="classFileSystemPath.html#ad1eabbab2c18a3907bbb0b413a03cf3f">base</a>());</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__libposix.html#ga54c5298a76b9c539d23fd647b1df996d">ESUCCESS</a>;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;}</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="classFileSystem.html#af4d56f27e3048e630b4cdf9f9cd46fcf">  135</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classFileSystem.html#af4d56f27e3048e630b4cdf9f9cd46fcf">FileSystem::pathHandler</a>(<a class="code" href="structFileSystemMessage.html">FileSystemMessage</a> *msg)</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;{</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">// Copy the request</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="classFileSystemRequest.html">FileSystemRequest</a> *req = <span class="keyword">new</span> <a class="code" href="classFileSystemRequest.html">FileSystemRequest</a>(msg);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">// Process the request.</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classFileSystem.html#a824d536860a0deb5be9ee61334105b40">processRequest</a>(req) == <a class="code" href="group__libposix.html#gaf0fac1cea1165b4debec7f686edf3313">EAGAIN</a>)</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <a class="code" href="classFileSystem.html#a28244f36400696951221689324d4ff26">m_requests</a>-&gt;<a class="code" href="classList.html#a1d98fead7daa6f5e58416552bad82941">append</a>(req);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keyword">delete</span> req;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;}</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="classFileSystem.html#a824d536860a0deb5be9ee61334105b40">  147</a></span>&#160;<a class="code" href="group__libstd.html#ga32561b1ad57f66e2ca93b07d45e9a9ee">Error</a> <a class="code" href="classFileSystem.html#a824d536860a0deb5be9ee61334105b40">FileSystem::processRequest</a>(<a class="code" href="classFileSystemRequest.html">FileSystemRequest</a> *req)</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;{</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordtype">char</span> buf[<a class="code" href="group__libfs.html#ga306ffcae7edd4e8e4f5779ad8359ee1c">PATHLEN</a>];</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <a class="code" href="classFileSystemPath.html">FileSystemPath</a> path;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="structFileCache.html">FileCache</a> *cache = <a class="code" href="group__libstd.html#gac328e551bde3d39b6d7b8cc9e048d941">ZERO</a>; </div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="classFile.html">File</a> *file = <a class="code" href="group__libstd.html#gac328e551bde3d39b6d7b8cc9e048d941">ZERO</a>;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="classDirectory.html">Directory</a> *parent;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="structFileSystemMessage.html">FileSystemMessage</a> *msg = req-&gt;<a class="code" href="classFileSystemRequest.html#ad6b15ff17aa1d38f42b0bdba9cb2edaa">getMessage</a>();</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="group__libstd.html#ga32561b1ad57f66e2ca93b07d45e9a9ee">Error</a> ret;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    </div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// Copy the file path</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">if</span> ((msg-&gt;<a class="code" href="structFileSystemMessage.html#ab85f29e74ab62487111284ad0a069192">result</a> = <a class="code" href="group__kernelapi.html#ga5be322040426be788bdc19a6ecf801a3">VMCopy</a>(msg-&gt;<a class="code" href="structFileSystemMessage.html#a9e629791993c89e3e60f51fa828424ab">from</a>, <a class="code" href="classAPI.html#ab458849e76e7c6f5b1788ffe74c6e0a8a67497437968f3b4197b1aa301fcbd65c">API::Read</a>, (<a class="code" href="group__libstd.html#ga153192b394630b5bbd32e3a430673674">Address</a>) buf,</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                    (<a class="code" href="group__libstd.html#ga153192b394630b5bbd32e3a430673674">Address</a>) msg-&gt;<a class="code" href="structFileSystemMessage.html#a393667a08dfdc40d9f1695e4ecb8aaee">path</a>, <a class="code" href="group__libfs.html#ga306ffcae7edd4e8e4f5779ad8359ee1c">PATHLEN</a>)) &lt;= 0)</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    {</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <a class="code" href="group__libstd.html#ga435175024ad996b2a45d734fa9eea0e3">ERROR</a>(<span class="stringliteral">&quot;path missing: result = &quot;</span> &lt;&lt; (<span class="keywordtype">int</span>)msg-&gt;<a class="code" href="structFileSystemMessage.html#ab85f29e74ab62487111284ad0a069192">result</a> &lt;&lt; <span class="stringliteral">&quot; from = &quot;</span> &lt;&lt; msg-&gt;<a class="code" href="structFileSystemMessage.html#a9e629791993c89e3e60f51fa828424ab">from</a> &lt;&lt;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;              <span class="stringliteral">&quot; addr = &quot;</span> &lt;&lt; (<span class="keywordtype">void</span> *) msg-&gt;<a class="code" href="structFileSystemMessage.html#a393667a08dfdc40d9f1695e4ecb8aaee">path</a> &lt;&lt; <span class="stringliteral">&quot; action = &quot;</span> &lt;&lt; (<span class="keywordtype">int</span>) msg-&gt;<a class="code" href="structFileSystemMessage.html#aae617cddbd9e2b04b093d9f34afc8d22">action</a> &lt;&lt; <span class="stringliteral">&quot; stat = &quot;</span> &lt;&lt; (<span class="keywordtype">void</span> *) msg-&gt;<a class="code" href="structFileSystemMessage.html#af75d6940638c6388f09dade8d7773b1b">stat</a>);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        msg-&gt;<a class="code" href="classChannelMessage.html#af8387313dcfe16279396f01cfcfc82f4">type</a> = <a class="code" href="classChannelMessage.html#ad507f5f87bd944c47c4fb531bd2b25eca29423c1e4bd0967c2fb46edf90d07371">ChannelMessage::Response</a>;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        msg-&gt;<a class="code" href="structFileSystemMessage.html#ab85f29e74ab62487111284ad0a069192">result</a> = <a class="code" href="group__libposix.html#gac2a2e9fa555401f94478f74e01868032">EACCES</a>;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <a class="code" href="classChannelServer.html#a8ca0774f62c838d5eda9d098dceac0e2">m_registry</a>-&gt;<a class="code" href="classChannelRegistry.html#ac2aed673427aec587152e2e50445c2f1">getProducer</a>(msg-&gt;<a class="code" href="structFileSystemMessage.html#a9e629791993c89e3e60f51fa828424ab">from</a>)-&gt;<a class="code" href="classChannel.html#a384120644263bda09c6b9141a4f45532">write</a>(msg);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordflow">return</span> msg-&gt;<a class="code" href="structFileSystemMessage.html#ab85f29e74ab62487111284ad0a069192">result</a>;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="group__libstd.html#gaecc1f7a8a2493b9e021e5bff76a00a5b">DEBUG</a>(<a class="code" href="classChannelServer.html#a9674726e6c23b4c1288a03adf6a82e3f">m_self</a> &lt;&lt; <span class="stringliteral">&quot;: path = &quot;</span> &lt;&lt; buf &lt;&lt; <span class="stringliteral">&quot; action = &quot;</span> &lt;&lt; msg-&gt;<a class="code" href="structFileSystemMessage.html#aae617cddbd9e2b04b093d9f34afc8d22">action</a>);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    path.<a class="code" href="classFileSystemPath.html#acc2141344b8c9e8003900fa63f15c60a">parse</a>(buf + <a class="code" href="group__libposix.html#ga0e7075c7598deb8dff05efcdb0d65ee2">strlen</a>(<a class="code" href="classFileSystem.html#ab3b50b840424b97f09c4b852441be98f">m_mountPath</a>));</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">// Do we have this file cached?</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">if</span> ((cache = <a class="code" href="classFileSystem.html#a8b2ba788f5a62495fa62a2576f49c821">findFileCache</a>(&amp;path)) ||</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        (cache = <a class="code" href="classFileSystem.html#a9d65b54d045d50e0cbd0551000d9d79f">lookupFile</a>(&amp;path)))</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    {</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        file = cache-&gt;<a class="code" href="structFileCache.html#ab17a76259eaa5bec47ca572e95c98a86">file</a>;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    }</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">// File not found</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="structFileSystemMessage.html#aae617cddbd9e2b04b093d9f34afc8d22">action</a> != <a class="code" href="classCreateFile.html">CreateFile</a>)</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    {</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <a class="code" href="group__libstd.html#gaecc1f7a8a2493b9e021e5bff76a00a5b">DEBUG</a>(<a class="code" href="classChannelServer.html#a9674726e6c23b4c1288a03adf6a82e3f">m_self</a> &lt;&lt; <span class="stringliteral">&quot;: not found&quot;</span>);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        msg-&gt;<a class="code" href="classChannelMessage.html#af8387313dcfe16279396f01cfcfc82f4">type</a> = <a class="code" href="classChannelMessage.html#ad507f5f87bd944c47c4fb531bd2b25eca29423c1e4bd0967c2fb46edf90d07371">ChannelMessage::Response</a>;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        msg-&gt;<a class="code" href="structFileSystemMessage.html#ab85f29e74ab62487111284ad0a069192">result</a> = <a class="code" href="group__libposix.html#ga03e689f378f643d16ea7537918528a48">ENOENT</a>;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <a class="code" href="classChannelServer.html#a8ca0774f62c838d5eda9d098dceac0e2">m_registry</a>-&gt;<a class="code" href="classChannelRegistry.html#ac2aed673427aec587152e2e50445c2f1">getProducer</a>(msg-&gt;<a class="code" href="structFileSystemMessage.html#a9e629791993c89e3e60f51fa828424ab">from</a>)-&gt;<a class="code" href="classChannel.html#a384120644263bda09c6b9141a4f45532">write</a>(msg);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <a class="code" href="group__kernelapi.html#ga12fbd36d91338390f4a6742d5014549b">ProcessCtl</a>(msg-&gt;<a class="code" href="structFileSystemMessage.html#a9e629791993c89e3e60f51fa828424ab">from</a>, <a class="code" href="group__kernelapi.html#ggad194eea1ab5db1371e5da2cc4f256a82a3e76e0644dbaf318b389719aab4e87da">Resume</a>, 0);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">return</span> msg-&gt;<a class="code" href="structFileSystemMessage.html#ab85f29e74ab62487111284ad0a069192">result</a>;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    }</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">// Perform I/O on the file</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">switch</span> (msg-&gt;<a class="code" href="structFileSystemMessage.html#aae617cddbd9e2b04b093d9f34afc8d22">action</a>)</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__libfs.html#gga48a52b001384d627326e5728208bbf96a663d39e7eb1c3642d09be4dc5702e192">CreateFile</a>:</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <span class="keywordflow">if</span> (cache)</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                msg-&gt;<a class="code" href="structFileSystemMessage.html#ab85f29e74ab62487111284ad0a069192">result</a> = <a class="code" href="group__libposix.html#ga0a3bef9e5c47e42917692b5dae3b5498">EEXIST</a>;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            {</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                <span class="comment">/* Attempt to create the new file. */</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                <span class="keywordflow">if</span> ((file = <a class="code" href="classFileSystem.html#a7c8b7ae0ac61411fb82f17d132fc0e36">createFile</a>(msg-&gt;<a class="code" href="structFileSystemMessage.html#a1fdf74c4cab11a3705fa8a7e75646224">filetype</a>, msg-&gt;<a class="code" href="structFileSystemMessage.html#af9da636fc5900a76d9b553bf3bbffb0a">deviceID</a>)))</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                {</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">char</span> *p = **path.<a class="code" href="classFileSystemPath.html#a16ee8c766b058b1c398beb02edb4caeb">full</a>();</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                    <a class="code" href="classFileSystem.html#a5fa50bab1ae9956dffcb6c92c0fbfd61">insertFileCache</a>(file, <span class="stringliteral">&quot;%s&quot;</span>, p);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            </div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                    <span class="comment">/* Add directory entry to our parent. */</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                    <span class="keywordflow">if</span> (path.<a class="code" href="classFileSystemPath.html#a2e2a8badda0bd8f29e2e28a34d7612a4">parent</a>())</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                    {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                        parent = (<a class="code" href="classDirectory.html">Directory</a> *) <a class="code" href="classFileSystem.html#a8b2ba788f5a62495fa62a2576f49c821">findFileCache</a>(**path.<a class="code" href="classFileSystemPath.html#a2e2a8badda0bd8f29e2e28a34d7612a4">parent</a>())-&gt;file;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                    }</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                        parent = (<a class="code" href="classDirectory.html">Directory</a> *) <a class="code" href="classFileSystem.html#ad3936cf61585445c95a04bc3f3c61dbc">m_root</a>-&gt;<a class="code" href="structFileCache.html#ab17a76259eaa5bec47ca572e95c98a86">file</a>;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                    parent-&gt;<a class="code" href="classDirectory.html#a60a813ddb9b7015efcddb7eb5bbbe1cb">insert</a>(file-&gt;<a class="code" href="classFile.html#aeeb18ed1a35f572f93d337ccb842e5fe">getType</a>(), **path.<a class="code" href="classFileSystemPath.html#a16ee8c766b058b1c398beb02edb4caeb">full</a>());</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                    msg-&gt;<a class="code" href="structFileSystemMessage.html#ab85f29e74ab62487111284ad0a069192">result</a> = <a class="code" href="group__libposix.html#ga54c5298a76b9c539d23fd647b1df996d">ESUCCESS</a>;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                }</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                    msg-&gt;<a class="code" href="structFileSystemMessage.html#ab85f29e74ab62487111284ad0a069192">result</a> = <a class="code" href="group__libposix.html#ga70979f50f9c83e5aebab3d6a1bd4cf35">EIO</a>;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            }</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <a class="code" href="group__libstd.html#gaecc1f7a8a2493b9e021e5bff76a00a5b">DEBUG</a>(<a class="code" href="classChannelServer.html#a9674726e6c23b4c1288a03adf6a82e3f">m_self</a> &lt;&lt; <span class="stringliteral">&quot;: create = &quot;</span> &lt;&lt; (<span class="keywordtype">int</span>)msg-&gt;<a class="code" href="structFileSystemMessage.html#ab85f29e74ab62487111284ad0a069192">result</a>);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__libfs.html#gga48a52b001384d627326e5728208bbf96a57479680371066393b8b4fdd05ab5600">DeleteFile</a>:</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <span class="keywordflow">if</span> (cache-&gt;<a class="code" href="structFileCache.html#a1ead0d74a10e2095470f8103422d4081">entries</a>.<a class="code" href="classHashTable.html#ac5738483b0125109f24eb6fbf10d4e05">count</a>() == 0)</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            {</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                <a class="code" href="classFileSystem.html#a78fa1c928f212f49b840c75f6d119ae0">clearFileCache</a>(cache);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                msg-&gt;<a class="code" href="structFileSystemMessage.html#ab85f29e74ab62487111284ad0a069192">result</a> = <a class="code" href="group__libposix.html#ga54c5298a76b9c539d23fd647b1df996d">ESUCCESS</a>;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                msg-&gt;<a class="code" href="structFileSystemMessage.html#ab85f29e74ab62487111284ad0a069192">result</a> = <a class="code" href="group__libposix.html#gaa0f602f3fd369a6fede82190710b9c5c">ENOTEMPTY</a>;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <a class="code" href="group__libstd.html#gaecc1f7a8a2493b9e021e5bff76a00a5b">DEBUG</a>(<a class="code" href="classChannelServer.html#a9674726e6c23b4c1288a03adf6a82e3f">m_self</a> &lt;&lt; <span class="stringliteral">&quot;: delete = &quot;</span> &lt;&lt; (<span class="keywordtype">int</span>)msg-&gt;<a class="code" href="structFileSystemMessage.html#ab85f29e74ab62487111284ad0a069192">result</a>);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__libfs.html#gga48a52b001384d627326e5728208bbf96ac6e76230ddc02752cf04f3505f60a387">StatFile</a>:</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            msg-&gt;<a class="code" href="structFileSystemMessage.html#ab85f29e74ab62487111284ad0a069192">result</a> = file-&gt;<a class="code" href="classFile.html#a44dfeceb2c3638b948aa5a7decb1a419">status</a>(msg);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            <a class="code" href="group__libstd.html#gaecc1f7a8a2493b9e021e5bff76a00a5b">DEBUG</a>(<a class="code" href="classChannelServer.html#a9674726e6c23b4c1288a03adf6a82e3f">m_self</a> &lt;&lt; <span class="stringliteral">&quot;: stat = &quot;</span> &lt;&lt; (<span class="keywordtype">int</span>)msg-&gt;<a class="code" href="structFileSystemMessage.html#ab85f29e74ab62487111284ad0a069192">result</a>);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__libfs.html#gga48a52b001384d627326e5728208bbf96a9980b102b1318893a80e5095fa02668c">ReadFile</a>:</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            {</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                msg-&gt;<a class="code" href="structFileSystemMessage.html#ab85f29e74ab62487111284ad0a069192">result</a> = file-&gt;<a class="code" href="classFile.html#a9b56b96a101ef2cd2f1638471868bc94">read</a>(req-&gt;<a class="code" href="classFileSystemRequest.html#abf1a127b828a3bab63b9c14df8c4df04">getBuffer</a>(), msg-&gt;<a class="code" href="structFileSystemMessage.html#ac6b86e3487be471a15a635bc65a2fc5e">size</a>, msg-&gt;<a class="code" href="structFileSystemMessage.html#adc8b46e7159ef0b68afc5cbeb14659b1">offset</a>);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                <span class="keywordflow">if</span> (req-&gt;<a class="code" href="classFileSystemRequest.html#abf1a127b828a3bab63b9c14df8c4df04">getBuffer</a>().<a class="code" href="classIOBuffer.html#a4d385a70c5fd475cf36709f9432fcd8c">getCount</a>())</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                    req-&gt;<a class="code" href="classFileSystemRequest.html#abf1a127b828a3bab63b9c14df8c4df04">getBuffer</a>().<a class="code" href="classIOBuffer.html#a24b9260dd43bcca8d5a0467d3cdd859a">flush</a>();</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            }</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <a class="code" href="group__libstd.html#gaecc1f7a8a2493b9e021e5bff76a00a5b">DEBUG</a>(<a class="code" href="classChannelServer.html#a9674726e6c23b4c1288a03adf6a82e3f">m_self</a> &lt;&lt; <span class="stringliteral">&quot;: read = &quot;</span> &lt;&lt; (<span class="keywordtype">int</span>)msg-&gt;<a class="code" href="structFileSystemMessage.html#ab85f29e74ab62487111284ad0a069192">result</a>);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        </div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__libfs.html#gga48a52b001384d627326e5728208bbf96a8ddf187149fd74f4224ddb3c25716793">WriteFile</a>:</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            {</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                <span class="keywordflow">if</span> (!req-&gt;<a class="code" href="classFileSystemRequest.html#abf1a127b828a3bab63b9c14df8c4df04">getBuffer</a>().<a class="code" href="classIOBuffer.html#a4d385a70c5fd475cf36709f9432fcd8c">getCount</a>())</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                    req-&gt;<a class="code" href="classFileSystemRequest.html#abf1a127b828a3bab63b9c14df8c4df04">getBuffer</a>().<a class="code" href="classIOBuffer.html#a535b021d5882b952e51f1419488b3687">bufferedRead</a>();</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                msg-&gt;<a class="code" href="structFileSystemMessage.html#ab85f29e74ab62487111284ad0a069192">result</a> = file-&gt;<a class="code" href="classFile.html#ad6f3a65a4a001f6a4550cdbec43ac5ba">write</a>(req-&gt;<a class="code" href="classFileSystemRequest.html#abf1a127b828a3bab63b9c14df8c4df04">getBuffer</a>(), msg-&gt;<a class="code" href="structFileSystemMessage.html#ac6b86e3487be471a15a635bc65a2fc5e">size</a>, msg-&gt;<a class="code" href="structFileSystemMessage.html#adc8b46e7159ef0b68afc5cbeb14659b1">offset</a>);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            }</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <a class="code" href="group__libstd.html#gaecc1f7a8a2493b9e021e5bff76a00a5b">DEBUG</a>(<a class="code" href="classChannelServer.html#a9674726e6c23b4c1288a03adf6a82e3f">m_self</a> &lt;&lt; <span class="stringliteral">&quot;: write = &quot;</span> &lt;&lt; (<span class="keywordtype">int</span>)msg-&gt;<a class="code" href="structFileSystemMessage.html#ab85f29e74ab62487111284ad0a069192">result</a>);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    }</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    ret = msg-&gt;<a class="code" href="structFileSystemMessage.html#ab85f29e74ab62487111284ad0a069192">result</a>;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">// Only send reply if completed (not EAGAIN)</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="structFileSystemMessage.html#ab85f29e74ab62487111284ad0a069192">result</a> != <a class="code" href="group__libposix.html#gaf0fac1cea1165b4debec7f686edf3313">EAGAIN</a>)</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    {</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <a class="code" href="classFileSystem.html#a3f4314a2f05e35242bc159bd890b9254">sendResponse</a>(msg);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    }</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;}</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="classFileSystem.html#a3f4314a2f05e35242bc159bd890b9254">  265</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classFileSystem.html#a3f4314a2f05e35242bc159bd890b9254">FileSystem::sendResponse</a>(<a class="code" href="structFileSystemMessage.html">FileSystemMessage</a> *msg)</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;{</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    msg-&gt;<a class="code" href="classChannelMessage.html#af8387313dcfe16279396f01cfcfc82f4">type</a> = <a class="code" href="classChannelMessage.html#ad507f5f87bd944c47c4fb531bd2b25eca29423c1e4bd0967c2fb46edf90d07371">ChannelMessage::Response</a>;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <a class="code" href="classChannelServer.html#a8ca0774f62c838d5eda9d098dceac0e2">m_registry</a>-&gt;<a class="code" href="classChannelRegistry.html#ac2aed673427aec587152e2e50445c2f1">getProducer</a>(msg-&gt;<a class="code" href="structFileSystemMessage.html#a9e629791993c89e3e60f51fa828424ab">from</a>)-&gt;<a class="code" href="classChannel.html#a384120644263bda09c6b9141a4f45532">write</a>(msg);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <a class="code" href="group__kernelapi.html#ga12fbd36d91338390f4a6742d5014549b">ProcessCtl</a>(msg-&gt;<a class="code" href="structFileSystemMessage.html#a9e629791993c89e3e60f51fa828424ab">from</a>, <a class="code" href="group__kernelapi.html#ggad194eea1ab5db1371e5da2cc4f256a82a3e76e0644dbaf318b389719aab4e87da">Resume</a>, 0);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;}</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno"><a class="line" href="classFileSystem.html#ab61f284c8936ac995fc3657370f4d6be">  272</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classFileSystem.html#ab61f284c8936ac995fc3657370f4d6be">FileSystem::timeout</a>()</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;{</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="group__libstd.html#gaecc1f7a8a2493b9e021e5bff76a00a5b">DEBUG</a>(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="classFileSystem.html#a95e2abd7d58f0dbb6c283616943db22a">retryRequests</a>());</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;}</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="classFileSystem.html#a95e2abd7d58f0dbb6c283616943db22a">  279</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classFileSystem.html#a95e2abd7d58f0dbb6c283616943db22a">FileSystem::retryRequests</a>()</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;{</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <a class="code" href="group__libstd.html#gaecc1f7a8a2493b9e021e5bff76a00a5b">DEBUG</a>(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordtype">bool</span> restartNeeded = <span class="keyword">false</span>;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classListIterator.html">ListIterator&lt;FileSystemRequest *&gt;</a> i(<a class="code" href="classFileSystem.html#a28244f36400696951221689324d4ff26">m_requests</a>); i.<a class="code" href="classListIterator.html#a6750d850524a46222fff4d24d1479f4c">hasCurrent</a>(); i++)</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    {</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <a class="code" href="group__libstd.html#ga32561b1ad57f66e2ca93b07d45e9a9ee">Error</a> ret = <a class="code" href="classFileSystem.html#a824d536860a0deb5be9ee61334105b40">processRequest</a>(i.current());</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordflow">if</span> (ret != <a class="code" href="group__libposix.html#gaf0fac1cea1165b4debec7f686edf3313">EAGAIN</a>)</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <span class="keyword">delete</span> i.current();</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            i.remove();</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            restartNeeded = <span class="keyword">true</span>;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        }</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="comment">/*Error set = ret &lt; 0 ? -ret : ret;</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">        </span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">        if (set &amp; (ERESTART))</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">        {</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">            DEBUG(&quot;ERESTART set: &quot; &lt;&lt; (int)ret &lt;&lt; &quot; : &quot; &lt;&lt; (int)set);</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">            restartNeeded = true;</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">        }*/</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    }</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <a class="code" href="group__libstd.html#gaecc1f7a8a2493b9e021e5bff76a00a5b">DEBUG</a>(<span class="stringliteral">&quot;done&quot;</span>);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">return</span> restartNeeded;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;}</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="classFileSystem.html#ab89c88c5961d6553e4517fc74b2744dc">  305</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classFileSystem.html#ab89c88c5961d6553e4517fc74b2744dc">FileSystem::setRoot</a>(<a class="code" href="classDirectory.html">Directory</a> *newRoot)</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;{</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <a class="code" href="classFileSystem.html#ad3936cf61585445c95a04bc3f3c61dbc">m_root</a> = <span class="keyword">new</span> <a class="code" href="group__libfs.html#gadbdf75ea9d1d6f836a928edb1be2f189">FileCache</a>(newRoot, <span class="stringliteral">&quot;/&quot;</span>, <a class="code" href="group__libstd.html#gac328e551bde3d39b6d7b8cc9e048d941">ZERO</a>);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <a class="code" href="classFileSystem.html#a5fa50bab1ae9956dffcb6c92c0fbfd61">insertFileCache</a>(newRoot, <span class="stringliteral">&quot;.&quot;</span>);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="classFileSystem.html#a5fa50bab1ae9956dffcb6c92c0fbfd61">insertFileCache</a>(newRoot, <span class="stringliteral">&quot;..&quot;</span>);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;}</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="classFileSystem.html#a9d65b54d045d50e0cbd0551000d9d79f">  312</a></span>&#160;<a class="code" href="structFileCache.html">FileCache</a> * <a class="code" href="classFileSystem.html#a9d65b54d045d50e0cbd0551000d9d79f">FileSystem::lookupFile</a>(<a class="code" href="classFileSystemPath.html">FileSystemPath</a> *path)</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;{</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="classList.html">List&lt;String *&gt;</a> *entries = path-&gt;<a class="code" href="classFileSystemPath.html#acf03c28bc958d8329a1e13275f71104e">split</a>();</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <a class="code" href="structFileCache.html">FileCache</a> *c = <a class="code" href="group__libstd.html#gac328e551bde3d39b6d7b8cc9e048d941">ZERO</a>;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <a class="code" href="classFile.html">File</a> *file = <a class="code" href="group__libstd.html#gac328e551bde3d39b6d7b8cc9e048d941">ZERO</a>;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <a class="code" href="classDirectory.html">Directory</a> *dir;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">/* Loop the entire path. */</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classListIterator.html">ListIterator&lt;String *&gt;</a> i(entries); i.<a class="code" href="classListIterator.html#a6750d850524a46222fff4d24d1479f4c">hasCurrent</a>(); i++)</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    {</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="comment">/* Start at root? */</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="keywordflow">if</span> (!c)</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        {</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            c = <a class="code" href="classFileSystem.html#ad3936cf61585445c95a04bc3f3c61dbc">m_root</a>;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        }</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="comment">/* Do we have this entry cached already? */</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="keywordflow">if</span> (!c-&gt;<a class="code" href="structFileCache.html#a1ead0d74a10e2095470f8103422d4081">entries</a>.<a class="code" href="classAssociative.html#a602e6677bddbe08bfd94663bd215e664">contains</a>(*i.current()))</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        {</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            <span class="comment">/* If this isn&#39;t a directory, we cannot perform a lookup. */</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structFileCache.html#ab17a76259eaa5bec47ca572e95c98a86">file</a>-&gt;<a class="code" href="classFile.html#aeeb18ed1a35f572f93d337ccb842e5fe">getType</a>() != <a class="code" href="group__libfs.html#gga2c794c5c13ab4dd7e65bad031dbe41c3a4d76dc89786987b3723c696e783bedd0">DirectoryFile</a>)</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="group__libstd.html#gac328e551bde3d39b6d7b8cc9e048d941">ZERO</a>;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            dir = (<a class="code" href="classDirectory.html">Directory</a> *) c-&gt;<a class="code" href="structFileCache.html#ab17a76259eaa5bec47ca572e95c98a86">file</a>;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            </div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <span class="comment">/* Fetch the file, if possible. */</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            if (!(file = dir-&gt;<a class="code" href="classDirectory.html#a383e9009e96c4ccc749a3cf149a3491d">lookup</a>(**i.current())))</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            {</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="group__libstd.html#gac328e551bde3d39b6d7b8cc9e048d941">ZERO</a>;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            }</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <span class="comment">/* Insert into the FileCache. */</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            c = <span class="keyword">new</span> <a class="code" href="group__libfs.html#gadbdf75ea9d1d6f836a928edb1be2f189">FileCache</a>(file, **i.current(), c);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        }</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="comment">/* Move to the next entry. */</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            c = (<a class="code" href="structFileCache.html">FileCache</a> *) c-&gt;<a class="code" href="structFileCache.html#a1ead0d74a10e2095470f8103422d4081">entries</a>.<a class="code" href="classHashTable.html#a0e5f4164b2a8a70006f92b5edd42098d">value</a>(*i.current());</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    }</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">/* All done. */</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">return</span> c;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;}</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno"><a class="line" href="classFileSystem.html#a5fa50bab1ae9956dffcb6c92c0fbfd61">  353</a></span>&#160;<a class="code" href="structFileCache.html">FileCache</a> * <a class="code" href="classFileSystem.html#a5fa50bab1ae9956dffcb6c92c0fbfd61">FileSystem::insertFileCache</a>(<a class="code" href="classFile.html">File</a> *file, <span class="keyword">const</span> <span class="keywordtype">char</span> *pathFormat, ...)</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;{</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <a class="code" href="stdarg_8h.html#a8c1b94dabde2c11f430bb83e37bdb0a1">va_list</a> args;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <a class="code" href="stdarg_8h.html#aa0628ab596c3d7e78f5e08c2d98e24da">va_start</a>(args, pathFormat);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <a class="code" href="structFileCache.html">FileCache</a> *c = <a class="code" href="classFileSystem.html#a5fa50bab1ae9956dffcb6c92c0fbfd61">insertFileCache</a>(file, pathFormat, args);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <a class="code" href="stdarg_8h.html#a823b205416e9129825841b74c3bf8484">va_end</a>(args);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">return</span> c;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;}</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno"><a class="line" href="classFileSystem.html#a4656343ab24a49aa9fb7c974a52ca9f0">  364</a></span>&#160;<a class="code" href="structFileCache.html">FileCache</a> * <a class="code" href="classFileSystem.html#a5fa50bab1ae9956dffcb6c92c0fbfd61">FileSystem::insertFileCache</a>(<a class="code" href="classFile.html">File</a> *file, <span class="keyword">const</span> <span class="keywordtype">char</span> *pathFormat, <a class="code" href="stdarg_8h.html#a8c1b94dabde2c11f430bb83e37bdb0a1">va_list</a> args)</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;{</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordtype">char</span> pathStr[<a class="code" href="group__libfs.html#ga306ffcae7edd4e8e4f5779ad8359ee1c">PATHLEN</a>];</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <a class="code" href="classFileSystemPath.html">FileSystemPath</a> path;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <a class="code" href="structFileCache.html">FileCache</a> *parent = <a class="code" href="group__libstd.html#gac328e551bde3d39b6d7b8cc9e048d941">ZERO</a>;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        </div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">// Format the path first</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <a class="code" href="group__libposix.html#gabef2233b05a7437b010fb9f88987330a">vsnprintf</a>(pathStr, <span class="keyword">sizeof</span>(pathStr), pathFormat, args);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">/* Interpret the given path. */</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    path.<a class="code" href="classFileSystemPath.html#acc2141344b8c9e8003900fa63f15c60a">parse</a>(pathStr);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        </div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="comment">/* Lookup our parent. */</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordflow">if</span> (!(path.<a class="code" href="classFileSystemPath.html#a2e2a8badda0bd8f29e2e28a34d7612a4">parent</a>()))</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    {</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        parent = <a class="code" href="classFileSystem.html#ad3936cf61585445c95a04bc3f3c61dbc">m_root</a>;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    }</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!(parent = <a class="code" href="classFileSystem.html#a8b2ba788f5a62495fa62a2576f49c821">findFileCache</a>(path.<a class="code" href="classFileSystemPath.html#a2e2a8badda0bd8f29e2e28a34d7612a4">parent</a>())))</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    {</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__libstd.html#gac328e551bde3d39b6d7b8cc9e048d941">ZERO</a>;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    }</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="comment">/* Create new cache. */</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="group__libfs.html#gadbdf75ea9d1d6f836a928edb1be2f189">FileCache</a>(file, **path.<a class="code" href="classFileSystemPath.html#ad1eabbab2c18a3907bbb0b413a03cf3f">base</a>(), parent);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;}</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno"><a class="line" href="classFileSystem.html#a8b2ba788f5a62495fa62a2576f49c821">  389</a></span>&#160;<a class="code" href="structFileCache.html">FileCache</a> * <a class="code" href="classFileSystem.html#a8b2ba788f5a62495fa62a2576f49c821">FileSystem::findFileCache</a>(<span class="keywordtype">char</span> *path)</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;{</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <a class="code" href="classFileSystemPath.html">FileSystemPath</a> p(path);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classFileSystem.html#a8b2ba788f5a62495fa62a2576f49c821">findFileCache</a>(&amp;p);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;}</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno"><a class="line" href="classFileSystem.html#aae81726e53ea0a19d0d6f9db6e5d0e6e">  395</a></span>&#160;<a class="code" href="structFileCache.html">FileCache</a> * <a class="code" href="classFileSystem.html#a8b2ba788f5a62495fa62a2576f49c821">FileSystem::findFileCache</a>(<a class="code" href="classString.html">String</a> *path)</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;{</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">return</span> path ? <a class="code" href="classFileSystem.html#a8b2ba788f5a62495fa62a2576f49c821">findFileCache</a>(**path) : <a class="code" href="group__libstd.html#gac328e551bde3d39b6d7b8cc9e048d941">ZERO</a>;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;}</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno"><a class="line" href="classFileSystem.html#a5b0e61e6d25f882bab0f2652e21f6c00">  400</a></span>&#160;<a class="code" href="structFileCache.html">FileCache</a> * <a class="code" href="classFileSystem.html#a8b2ba788f5a62495fa62a2576f49c821">FileSystem::findFileCache</a>(<a class="code" href="classFileSystemPath.html">FileSystemPath</a> *p)</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;{</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <a class="code" href="classList.html">List&lt;String *&gt;</a> *entries = p-&gt;<a class="code" href="classFileSystemPath.html#acf03c28bc958d8329a1e13275f71104e">split</a>();</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <a class="code" href="structFileCache.html">FileCache</a> *c = <a class="code" href="classFileSystem.html#ad3936cf61585445c95a04bc3f3c61dbc">m_root</a>;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="comment">/* Root is treated special. */</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">if</span> (!p-&gt;<a class="code" href="classFileSystemPath.html#a2e2a8badda0bd8f29e2e28a34d7612a4">parent</a>() &amp;&amp; p-&gt;<a class="code" href="classFileSystemPath.html#ad3a2d1bf0f25a1f9681694b48d87d991">length</a>() == 0)</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    {</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classFileSystem.html#ad3936cf61585445c95a04bc3f3c61dbc">m_root</a>;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    }</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="comment">/* Loop the entire path. */</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classListIterator.html">ListIterator&lt;String *&gt;</a> i(entries); i.<a class="code" href="classListIterator.html#a6750d850524a46222fff4d24d1479f4c">hasCurrent</a>(); i++)</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    {</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <span class="keywordflow">if</span> (!c-&gt;<a class="code" href="structFileCache.html#a1ead0d74a10e2095470f8103422d4081">entries</a>.<a class="code" href="classAssociative.html#a602e6677bddbe08bfd94663bd215e664">contains</a>(*i.current()))</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="group__libstd.html#gac328e551bde3d39b6d7b8cc9e048d941">ZERO</a>;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        c = (<a class="code" href="structFileCache.html">FileCache</a> *) c-&gt;<a class="code" href="structFileCache.html#a1ead0d74a10e2095470f8103422d4081">entries</a>.<a class="code" href="classHashTable.html#a0e5f4164b2a8a70006f92b5edd42098d">value</a>(*i.current());</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    }</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">/* Perform cachehit? */</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">if</span> (c)</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    {</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <a class="code" href="classFileSystem.html#a0cec61006e34d87dce991d0b352001de">cacheHit</a>(c);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    }</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="comment">/* Return what we got. */</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">return</span> c &amp;&amp; c-&gt;<a class="code" href="structFileCache.html#a980b0dc227176a60223f0b5ad84bcbf3">valid</a> ? c : <a class="code" href="group__libstd.html#gac328e551bde3d39b6d7b8cc9e048d941">ZERO</a>;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;}</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno"><a class="line" href="classFileSystem.html#a0cec61006e34d87dce991d0b352001de">  427</a></span>&#160;<a class="code" href="structFileCache.html">FileCache</a> * <a class="code" href="classFileSystem.html#a0cec61006e34d87dce991d0b352001de">FileSystem::cacheHit</a>(<a class="code" href="structFileCache.html">FileCache</a> *cache)</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;{</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">return</span> cache;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;}</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno"><a class="line" href="classFileSystem.html#a78fa1c928f212f49b840c75f6d119ae0">  432</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classFileSystem.html#a78fa1c928f212f49b840c75f6d119ae0">FileSystem::clearFileCache</a>(<a class="code" href="structFileCache.html">FileCache</a> *cache)</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;{</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="comment">/* Start from root? */</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">if</span> (!cache)</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    {</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        cache = <a class="code" href="classFileSystem.html#ad3936cf61585445c95a04bc3f3c61dbc">m_root</a>;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    }</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="comment">/* Mark invalid immediately. */</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        cache-&gt;<a class="code" href="structFileCache.html#a980b0dc227176a60223f0b5ad84bcbf3">valid</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="comment">/* Walk all our childs. */</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classHashIterator.html">HashIterator&lt;String, FileCache *&gt;</a> i(cache-&gt;<a class="code" href="structFileCache.html#a1ead0d74a10e2095470f8103422d4081">entries</a>); i.<a class="code" href="classHashIterator.html#ae0e2e0d8c2b992aa6734059ac052bb0d">hasCurrent</a>(); i++)</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    {</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="comment">/* Traverse subtree if it isn&#39;t invalidated yet. */</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="keywordflow">if</span> (i.current()-&gt;valid)</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        {</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            <a class="code" href="classFileSystem.html#a78fa1c928f212f49b840c75f6d119ae0">clearFileCache</a>(i.current());</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            i.remove();</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        }</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    }</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="comment">/* Remove the entry itself, if empty. */</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordflow">if</span> (!cache-&gt;<a class="code" href="structFileCache.html#a980b0dc227176a60223f0b5ad84bcbf3">valid</a> &amp;&amp; cache-&gt;<a class="code" href="structFileCache.html#a1ead0d74a10e2095470f8103422d4081">entries</a>.<a class="code" href="classHashTable.html#ac5738483b0125109f24eb6fbf10d4e05">count</a>() == 0)</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    {</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="comment">/* Remove entry from parent */</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="keywordflow">if</span> (cache-&gt;<a class="code" href="structFileCache.html#ae49028ad84ac22d14f2395c4cd8da174">parent</a>)</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        {</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            ((<a class="code" href="classDirectory.html">Directory</a> *) cache-&gt;<a class="code" href="structFileCache.html#ae49028ad84ac22d14f2395c4cd8da174">parent</a>-&gt;<a class="code" href="structFileCache.html#ab17a76259eaa5bec47ca572e95c98a86">file</a>)-&gt;remove(*cache-&gt;<a class="code" href="structFileCache.html#ab4ffe23da29854380b7b12d77700b674">name</a>);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            cache-&gt;<a class="code" href="structFileCache.html#ae49028ad84ac22d14f2395c4cd8da174">parent</a>-&gt;<a class="code" href="structFileCache.html#a1ead0d74a10e2095470f8103422d4081">entries</a>.<a class="code" href="classHashTable.html#a12836fdb84369843bb6472ab71e8634a">remove</a>(cache-&gt;<a class="code" href="structFileCache.html#ab4ffe23da29854380b7b12d77700b674">name</a>);</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        }</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="keyword">delete</span> cache-&gt;<a class="code" href="structFileCache.html#ab17a76259eaa5bec47ca572e95c98a86">file</a>;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="keyword">delete</span> cache;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    }</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;}</div><div class="ttc" id="classFileSystemRequest_html_abf1a127b828a3bab63b9c14df8c4df04"><div class="ttname"><a href="classFileSystemRequest.html#abf1a127b828a3bab63b9c14df8c4df04">FileSystemRequest::getBuffer</a></div><div class="ttdeci">IOBuffer &amp; getBuffer()</div><div class="ttdoc">Get IOBuffer. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystemRequest_8cpp_source.html#l00036">FileSystemRequest.cpp:36</a></div></div>
<div class="ttc" id="group__kernelapi_html_ga75af299153b77c625ac783ad539794dc"><div class="ttname"><a href="group__kernelapi.html#ga75af299153b77c625ac783ad539794dc">SYSFS_PID</a></div><div class="ttdeci">#define SYSFS_PID</div><div class="ttdef"><b>Definition:</b> <a href="ProcessID_8h_source.html#l00039">ProcessID.h:39</a></div></div>
<div class="ttc" id="group__libposix_html_ga58a036bfd8b45901c15535c179e74be6"><div class="ttname"><a href="group__libposix.html#ga58a036bfd8b45901c15535c179e74be6">errno</a></div><div class="ttdeci">C int errno</div><div class="ttdoc">The lvalue errno is used by many functions to return error values. </div></div>
<div class="ttc" id="group__libposix_html_gac759c3c657671c9979da89ccfc7782aa"><div class="ttname"><a href="group__libposix.html#gac759c3c657671c9979da89ccfc7782aa">write</a></div><div class="ttdeci">ssize_t write(int fildes, const void *buf, size_t nbyte)</div><div class="ttdoc">Write on a file. </div><div class="ttdef"><b>Definition:</b> <a href="write_8cpp_source.html#l00024">write.cpp:24</a></div></div>
<div class="ttc" id="classFileSystem_html_ab89c88c5961d6553e4517fc74b2744dc"><div class="ttname"><a href="classFileSystem.html#ab89c88c5961d6553e4517fc74b2744dc">FileSystem::setRoot</a></div><div class="ttdeci">void setRoot(Directory *newRoot)</div><div class="ttdoc">Change the filesystem root directory. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8cpp_source.html#l00305">FileSystem.cpp:305</a></div></div>
<div class="ttc" id="structFileCache_html_ab4ffe23da29854380b7b12d77700b674"><div class="ttname"><a href="structFileCache.html#ab4ffe23da29854380b7b12d77700b674">FileCache::name</a></div><div class="ttdeci">String name</div><div class="ttdoc">Our name. </div><div class="ttdef"><b>Definition:</b> <a href="FileCache_8h_source.html#l00071">FileCache.h:71</a></div></div>
<div class="ttc" id="classFileSystem_html_a9e366f036e9d9cd884fa689963aacc49"><div class="ttname"><a href="classFileSystem.html#a9e366f036e9d9cd884fa689963aacc49">FileSystem::~FileSystem</a></div><div class="ttdeci">virtual ~FileSystem()</div><div class="ttdoc">Destructor function. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8cpp_source.html#l00044">FileSystem.cpp:44</a></div></div>
<div class="ttc" id="classFileSystemPath_html_acc2141344b8c9e8003900fa63f15c60a"><div class="ttname"><a href="classFileSystemPath.html#acc2141344b8c9e8003900fa63f15c60a">FileSystemPath::parse</a></div><div class="ttdeci">void parse(const char *p, char sep=DEFAULT_SEPARATOR)</div><div class="ttdoc">Parses a given character string as the path. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystemPath_8cpp_source.html#l00064">FileSystemPath.cpp:64</a></div></div>
<div class="ttc" id="classCreateFile_html"><div class="ttname"><a href="classCreateFile.html">CreateFile</a></div><div class="ttdoc">Create new files on the filesystem. </div><div class="ttdef"><b>Definition:</b> <a href="CreateFile_8h_source.html#l00031">CreateFile.h:31</a></div></div>
<div class="ttc" id="group__libfs_html_gga2c794c5c13ab4dd7e65bad031dbe41c3a4d76dc89786987b3723c696e783bedd0"><div class="ttname"><a href="group__libfs.html#gga2c794c5c13ab4dd7e65bad031dbe41c3a4d76dc89786987b3723c696e783bedd0">DirectoryFile</a></div><div class="ttdef"><b>Definition:</b> <a href="FileType_8h_source.html#l00064">FileType.h:64</a></div></div>
<div class="ttc" id="structFileSystemMount_html_af32632b6c19c2c3ad98ee66fc8dc4109"><div class="ttname"><a href="structFileSystemMount.html#af32632b6c19c2c3ad98ee66fc8dc4109">FileSystemMount::path</a></div><div class="ttdeci">char path[PATH_MAX]</div><div class="ttdoc">Path of the mount. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystemMount_8h_source.html#l00041">FileSystemMount.h:41</a></div></div>
<div class="ttc" id="group__libposix_html_ga0e7075c7598deb8dff05efcdb0d65ee2"><div class="ttname"><a href="group__libposix.html#ga0e7075c7598deb8dff05efcdb0d65ee2">strlen</a></div><div class="ttdeci">size_t strlen(const char *str)</div><div class="ttdoc">Calculate the length of a string. </div><div class="ttdef"><b>Definition:</b> <a href="strlen_8cpp_source.html#l00021">strlen.cpp:21</a></div></div>
<div class="ttc" id="group__libstd_html_ga153192b394630b5bbd32e3a430673674"><div class="ttname"><a href="group__libstd.html#ga153192b394630b5bbd32e3a430673674">Address</a></div><div class="ttdeci">unsigned long Address</div><div class="ttdoc">A memory address. </div><div class="ttdef"><b>Definition:</b> <a href="Types_8h_source.html#l00131">Types.h:131</a></div></div>
<div class="ttc" id="classFileSystem_html"><div class="ttname"><a href="classFileSystem.html">FileSystem</a></div><div class="ttdoc">Abstract filesystem class. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8h_source.html#l00043">FileSystem.h:43</a></div></div>
<div class="ttc" id="classChannelServer_html_a9674726e6c23b4c1288a03adf6a82e3f"><div class="ttname"><a href="classChannelServer.html#a9674726e6c23b4c1288a03adf6a82e3f">ChannelServer&lt; FileSystem, FileSystemMessage &gt;::m_self</a></div><div class="ttdeci">ProcessID m_self</div><div class="ttdoc">ProcessID of ourselves. </div><div class="ttdef"><b>Definition:</b> <a href="ChannelServer_8h_source.html#l00425">ChannelServer.h:425</a></div></div>
<div class="ttc" id="classDirectory_html_a60a813ddb9b7015efcddb7eb5bbbe1cb"><div class="ttname"><a href="classDirectory.html#a60a813ddb9b7015efcddb7eb5bbbe1cb">Directory::insert</a></div><div class="ttdeci">void insert(FileType type, const char *name,...)</div><div class="ttdoc">Insert a new directory entry. </div><div class="ttdef"><b>Definition:</b> <a href="Directory_8cpp_source.html#l00058">Directory.cpp:58</a></div></div>
<div class="ttc" id="classDirectory_html"><div class="ttname"><a href="classDirectory.html">Directory</a></div><div class="ttdoc">Directory File functionality. </div><div class="ttdef"><b>Definition:</b> <a href="Directory_8h_source.html#l00072">Directory.h:72</a></div></div>
<div class="ttc" id="classFileSystemPath_html_a2e2a8badda0bd8f29e2e28a34d7612a4"><div class="ttname"><a href="classFileSystemPath.html#a2e2a8badda0bd8f29e2e28a34d7612a4">FileSystemPath::parent</a></div><div class="ttdeci">String * parent() const</div><div class="ttdoc">Retrieve the full path of our parent. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystemPath_8cpp_source.html#l00104">FileSystemPath.cpp:104</a></div></div>
<div class="ttc" id="group__libposix_html_gaf0fac1cea1165b4debec7f686edf3313"><div class="ttname"><a href="group__libposix.html#gaf0fac1cea1165b4debec7f686edf3313">EAGAIN</a></div><div class="ttdeci">#define EAGAIN</div><div class="ttdoc">Resource unavailable, try again (may be the same value as [EWOULDBLOCK]). </div><div class="ttdef"><b>Definition:</b> <a href="errno_8h_source.html#l00061">errno.h:61</a></div></div>
<div class="ttc" id="group__kernelapi_html_ggad194eea1ab5db1371e5da2cc4f256a82a3e76e0644dbaf318b389719aab4e87da"><div class="ttname"><a href="group__kernelapi.html#ggad194eea1ab5db1371e5da2cc4f256a82a3e76e0644dbaf318b389719aab4e87da">Resume</a></div><div class="ttdef"><b>Definition:</b> <a href="ProcessCtl_8h_source.html#l00053">ProcessCtl.h:53</a></div></div>
<div class="ttc" id="group__libfs_html_gadbdf75ea9d1d6f836a928edb1be2f189"><div class="ttname"><a href="group__libfs.html#gadbdf75ea9d1d6f836a928edb1be2f189">FileCache</a></div><div class="ttdeci">struct FileCache FileCache</div><div class="ttdoc">Cached in-memory file. </div></div>
<div class="ttc" id="classFileSystemRequest_html"><div class="ttname"><a href="classFileSystemRequest.html">FileSystemRequest</a></div><div class="ttdoc">Encapsulates a pending FileSystemMessage. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystemRequest_8h_source.html#l00035">FileSystemRequest.h:35</a></div></div>
<div class="ttc" id="classHashIterator_html"><div class="ttname"><a href="classHashIterator.html">HashIterator</a></div><div class="ttdoc">Iterate through a HashTable. </div><div class="ttdef"><b>Definition:</b> <a href="HashIterator_8h_source.html#l00039">HashIterator.h:39</a></div></div>
<div class="ttc" id="classList_html_a1d98fead7daa6f5e58416552bad82941"><div class="ttname"><a href="classList.html#a1d98fead7daa6f5e58416552bad82941">List::append</a></div><div class="ttdeci">void append(T t)</div><div class="ttdoc">Insert an item at the end of the list. </div><div class="ttdef"><b>Definition:</b> <a href="List_8h_source.html#l00140">List.h:140</a></div></div>
<div class="ttc" id="group__libposix_html_ga54c5298a76b9c539d23fd647b1df996d"><div class="ttname"><a href="group__libposix.html#ga54c5298a76b9c539d23fd647b1df996d">ESUCCESS</a></div><div class="ttdeci">#define ESUCCESS</div><div class="ttdoc">Reports a success operation. </div><div class="ttdef"><b>Definition:</b> <a href="errno_8h_source.html#l00043">errno.h:43</a></div></div>
<div class="ttc" id="structFileCache_html_a980b0dc227176a60223f0b5ad84bcbf3"><div class="ttname"><a href="structFileCache.html#a980b0dc227176a60223f0b5ad84bcbf3">FileCache::valid</a></div><div class="ttdeci">bool valid</div><div class="ttdoc">Is this entry still valid?. </div><div class="ttdef"><b>Definition:</b> <a href="FileCache_8h_source.html#l00077">FileCache.h:77</a></div></div>
<div class="ttc" id="classChannelServer_html"><div class="ttname"><a href="classChannelServer.html">ChannelServer</a></div><div class="ttdoc">Template class which serves incoming messages from Channels using MessageHandlers. </div><div class="ttdef"><b>Definition:</b> <a href="ChannelServer_8h_source.html#l00065">ChannelServer.h:65</a></div></div>
<div class="ttc" id="classIOBuffer_html_a535b021d5882b952e51f1419488b3687"><div class="ttname"><a href="classIOBuffer.html#a535b021d5882b952e51f1419488b3687">IOBuffer::bufferedRead</a></div><div class="ttdeci">Error bufferedRead()</div><div class="ttdoc">Buffered read bytes from message to the I/O buffer. </div><div class="ttdef"><b>Definition:</b> <a href="IOBuffer_8cpp_source.html#l00053">IOBuffer.cpp:53</a></div></div>
<div class="ttc" id="group__libfs_html_ga2c794c5c13ab4dd7e65bad031dbe41c3"><div class="ttname"><a href="group__libfs.html#ga2c794c5c13ab4dd7e65bad031dbe41c3">FileType</a></div><div class="ttdeci">FileType</div><div class="ttdoc">All possible filetypes. </div><div class="ttdef"><b>Definition:</b> <a href="FileType_8h_source.html#l00061">FileType.h:61</a></div></div>
<div class="ttc" id="group__kernelapi_html_ga454bd0719880383528ea39b0771f1010"><div class="ttname"><a href="group__kernelapi.html#ga454bd0719880383528ea39b0771f1010">ROOTFS_PID</a></div><div class="ttdeci">#define ROOTFS_PID</div><div class="ttdef"><b>Definition:</b> <a href="ProcessID_8h_source.html#l00040">ProcessID.h:40</a></div></div>
<div class="ttc" id="classFileSystemPath_html_ad1eabbab2c18a3907bbb0b413a03cf3f"><div class="ttname"><a href="classFileSystemPath.html#ad1eabbab2c18a3907bbb0b413a03cf3f">FileSystemPath::base</a></div><div class="ttdeci">String * base() const</div><div class="ttdoc">The name of the last element in the path. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystemPath_8cpp_source.html#l00109">FileSystemPath.cpp:109</a></div></div>
<div class="ttc" id="structFileCache_html_ab17a76259eaa5bec47ca572e95c98a86"><div class="ttname"><a href="structFileCache.html#ab17a76259eaa5bec47ca572e95c98a86">FileCache::file</a></div><div class="ttdeci">File * file</div><div class="ttdoc">File pointer. </div><div class="ttdef"><b>Definition:</b> <a href="FileCache_8h_source.html#l00068">FileCache.h:68</a></div></div>
<div class="ttc" id="fcntl_8h_html"><div class="ttname"><a href="fcntl_8h.html">fcntl.h</a></div></div>
<div class="ttc" id="classAPI_html_ab458849e76e7c6f5b1788ffe74c6e0a8a67497437968f3b4197b1aa301fcbd65c"><div class="ttname"><a href="classAPI.html#ab458849e76e7c6f5b1788ffe74c6e0a8a67497437968f3b4197b1aa301fcbd65c">API::Read</a></div><div class="ttdef"><b>Definition:</b> <a href="API_8h_source.html#l00094">API.h:94</a></div></div>
<div class="ttc" id="group__libstd_html_ga435175024ad996b2a45d734fa9eea0e3"><div class="ttname"><a href="group__libstd.html#ga435175024ad996b2a45d734fa9eea0e3">ERROR</a></div><div class="ttdeci">#define ERROR(msg)</div><div class="ttdoc">Output an error message. </div><div class="ttdef"><b>Definition:</b> <a href="Log_8h_source.html#l00058">Log.h:58</a></div></div>
<div class="ttc" id="classChannelServer_html_a8a2abcf4992a5431dea74e4321f2da9c"><div class="ttname"><a href="classChannelServer.html#a8a2abcf4992a5431dea74e4321f2da9c">ChannelServer&lt; FileSystem, FileSystemMessage &gt;::addIPCHandler</a></div><div class="ttdeci">void addIPCHandler(Size slot, IPCHandlerFunction h, bool sendReply=true)</div><div class="ttdoc">Register a new IPC message action handler. </div><div class="ttdef"><b>Definition:</b> <a href="ChannelServer_8h_source.html#l00196">ChannelServer.h:196</a></div></div>
<div class="ttc" id="classFileSystem_html_ad3936cf61585445c95a04bc3f3c61dbc"><div class="ttname"><a href="classFileSystem.html#ad3936cf61585445c95a04bc3f3c61dbc">FileSystem::m_root</a></div><div class="ttdeci">FileCache * m_root</div><div class="ttdoc">Root entry of the filesystem tree. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8h_source.html#l00254">FileSystem.h:254</a></div></div>
<div class="ttc" id="group__libposix_html_gabef2233b05a7437b010fb9f88987330a"><div class="ttname"><a href="group__libposix.html#gabef2233b05a7437b010fb9f88987330a">vsnprintf</a></div><div class="ttdeci">int vsnprintf(char *buffer, unsigned int size, const char *fmt, va_list args)</div><div class="ttdoc">Write a formatted string into a buffer. </div><div class="ttdef"><b>Definition:</b> <a href="vsnprintf_8cpp_source.html#l00023">vsnprintf.cpp:23</a></div></div>
<div class="ttc" id="group__libfs_html_gga48a52b001384d627326e5728208bbf96a8ddf187149fd74f4224ddb3c25716793"><div class="ttname"><a href="group__libfs.html#gga48a52b001384d627326e5728208bbf96a8ddf187149fd74f4224ddb3c25716793">WriteFile</a></div><div class="ttdef"><b>Definition:</b> <a href="FileSystemMessage_8h_source.html#l00043">FileSystemMessage.h:43</a></div></div>
<div class="ttc" id="structFileCache_html_a1ead0d74a10e2095470f8103422d4081"><div class="ttname"><a href="structFileCache.html#a1ead0d74a10e2095470f8103422d4081">FileCache::entries</a></div><div class="ttdeci">HashTable&lt; String, FileCache * &gt; entries</div><div class="ttdoc">Contains childs. </div><div class="ttdef"><b>Definition:</b> <a href="FileCache_8h_source.html#l00074">FileCache.h:74</a></div></div>
<div class="ttc" id="classFileSystem_html_abbcf90e56a0063b6ce287d5198fd65d2"><div class="ttname"><a href="classFileSystem.html#abbcf90e56a0063b6ce287d5198fd65d2">FileSystem::getMountPath</a></div><div class="ttdeci">const char * getMountPath() const</div><div class="ttdoc">Get mount path. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8cpp_source.html#l00050">FileSystem.cpp:50</a></div></div>
<div class="ttc" id="group__libposix_html_gac2a2e9fa555401f94478f74e01868032"><div class="ttname"><a href="group__libposix.html#gac2a2e9fa555401f94478f74e01868032">EACCES</a></div><div class="ttdeci">#define EACCES</div><div class="ttdoc">Permission denied. </div><div class="ttdef"><b>Definition:</b> <a href="errno_8h_source.html#l00049">errno.h:49</a></div></div>
<div class="ttc" id="classString_html"><div class="ttname"><a href="classString.html">String</a></div><div class="ttdoc">Abstraction of strings. </div><div class="ttdef"><b>Definition:</b> <a href="String_8h_source.html#l00041">String.h:41</a></div></div>
<div class="ttc" id="classHashTable_html_a12836fdb84369843bb6472ab71e8634a"><div class="ttname"><a href="classHashTable.html#a12836fdb84369843bb6472ab71e8634a">HashTable::remove</a></div><div class="ttdeci">virtual int remove(const K &amp;key)</div><div class="ttdoc">Remove value(s) for the given key. </div><div class="ttdef"><b>Definition:</b> <a href="HashTable_8h_source.html#l00182">HashTable.h:182</a></div></div>
<div class="ttc" id="stat_8h_html"><div class="ttname"><a href="stat_8h.html">stat.h</a></div></div>
<div class="ttc" id="stdarg_8h_html_a8c1b94dabde2c11f430bb83e37bdb0a1"><div class="ttname"><a href="stdarg_8h.html#a8c1b94dabde2c11f430bb83e37bdb0a1">va_list</a></div><div class="ttdeci">__gnuc_va_list va_list</div><div class="ttdef"><b>Definition:</b> <a href="stdarg_8h_source.html#l00105">stdarg.h:105</a></div></div>
<div class="ttc" id="Runtime_8h_html"><div class="ttname"><a href="Runtime_8h.html">Runtime.h</a></div></div>
<div class="ttc" id="stdarg_8h_html_a823b205416e9129825841b74c3bf8484"><div class="ttname"><a href="stdarg_8h.html#a823b205416e9129825841b74c3bf8484">va_end</a></div><div class="ttdeci">#define va_end(v)</div><div class="ttdef"><b>Definition:</b> <a href="stdarg_8h_source.html#l00051">stdarg.h:51</a></div></div>
<div class="ttc" id="classFileSystem_html_a5aa6054b8d9277cf1fefe87f71fc89cf"><div class="ttname"><a href="classFileSystem.html#a5aa6054b8d9277cf1fefe87f71fc89cf">FileSystem::mount</a></div><div class="ttdeci">Error mount()</div><div class="ttdoc">Mount the FileSystem. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8cpp_source.html#l00060">FileSystem.cpp:60</a></div></div>
<div class="ttc" id="group__libposix_html_ga11b644a8526139c4cc1850dac1271ced"><div class="ttname"><a href="group__libposix.html#ga11b644a8526139c4cc1850dac1271ced">O_WRONLY</a></div><div class="ttdeci">#define O_WRONLY</div><div class="ttdoc">Open for writing only. </div><div class="ttdef"><b>Definition:</b> <a href="fcntl_8h_source.html#l00093">fcntl.h:93</a></div></div>
<div class="ttc" id="structFileSystemMessage_html_adc8b46e7159ef0b68afc5cbeb14659b1"><div class="ttname"><a href="structFileSystemMessage.html#adc8b46e7159ef0b68afc5cbeb14659b1">FileSystemMessage::offset</a></div><div class="ttdeci">Size offset</div><div class="ttdoc">Offset in the file for I/O. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystemMessage_8h_source.html#l00106">FileSystemMessage.h:106</a></div></div>
<div class="ttc" id="group__libposix_html_ga2533b93d6921573ef2b7b51f6f5773be"><div class="ttname"><a href="group__libposix.html#ga2533b93d6921573ef2b7b51f6f5773be">open</a></div><div class="ttdeci">int open(const char *path, int oflag,...)</div><div class="ttdoc">Open file relative to directory file descriptor. </div><div class="ttdef"><b>Definition:</b> <a href="open_8cpp_source.html#l00026">open.cpp:26</a></div></div>
<div class="ttc" id="classChannelMessage_html_ad507f5f87bd944c47c4fb531bd2b25eca29423c1e4bd0967c2fb46edf90d07371"><div class="ttname"><a href="classChannelMessage.html#ad507f5f87bd944c47c4fb531bd2b25eca29423c1e4bd0967c2fb46edf90d07371">ChannelMessage::Response</a></div><div class="ttdef"><b>Definition:</b> <a href="ChannelMessage_8h_source.html#l00044">ChannelMessage.h:44</a></div></div>
<div class="ttc" id="group__libposix_html_gae688d728e1acdfe5988c7db45d6f0166"><div class="ttname"><a href="group__libposix.html#gae688d728e1acdfe5988c7db45d6f0166">PATH_MAX</a></div><div class="ttdeci">#define PATH_MAX</div><div class="ttdoc">Maximum file path length. </div><div class="ttdef"><b>Definition:</b> <a href="limits_8h_source.html#l00036">limits.h:36</a></div></div>
<div class="ttc" id="classFileSystem_html_a3f4314a2f05e35242bc159bd890b9254"><div class="ttname"><a href="classFileSystem.html#a3f4314a2f05e35242bc159bd890b9254">FileSystem::sendResponse</a></div><div class="ttdeci">void sendResponse(FileSystemMessage *msg)</div><div class="ttdoc">Send response for a FileSystemMessage. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8cpp_source.html#l00265">FileSystem.cpp:265</a></div></div>
<div class="ttc" id="group__kernelapi_html_ga5be322040426be788bdc19a6ecf801a3"><div class="ttname"><a href="group__kernelapi.html#ga5be322040426be788bdc19a6ecf801a3">VMCopy</a></div><div class="ttdeci">API::Result VMCopy(ProcessID proc, API::Operation how, Address ours, Address theirs, Size sz)</div><div class="ttdoc">Prototype for user applications. </div><div class="ttdef"><b>Definition:</b> <a href="VMCopy_8h_source.html#l00042">VMCopy.h:42</a></div></div>
<div class="ttc" id="classFileSystemRequest_html_ad6b15ff17aa1d38f42b0bdba9cb2edaa"><div class="ttname"><a href="classFileSystemRequest.html#ad6b15ff17aa1d38f42b0bdba9cb2edaa">FileSystemRequest::getMessage</a></div><div class="ttdeci">FileSystemMessage * getMessage()</div><div class="ttdoc">Get message. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystemRequest_8cpp_source.html#l00031">FileSystemRequest.cpp:31</a></div></div>
<div class="ttc" id="classIOBuffer_html_a24b9260dd43bcca8d5a0467d3cdd859a"><div class="ttname"><a href="classIOBuffer.html#a24b9260dd43bcca8d5a0467d3cdd859a">IOBuffer::flush</a></div><div class="ttdeci">Error flush() const</div><div class="ttdoc">Flush write buffers. </div><div class="ttdef"><b>Definition:</b> <a href="IOBuffer_8cpp_source.html#l00087">IOBuffer.cpp:87</a></div></div>
<div class="ttc" id="classFile_html_ad6f3a65a4a001f6a4550cdbec43ac5ba"><div class="ttname"><a href="classFile.html#ad6f3a65a4a001f6a4550cdbec43ac5ba">File::write</a></div><div class="ttdeci">virtual Error write(IOBuffer &amp;buffer, Size size, Size offset)</div><div class="ttdoc">Write bytes to the file. </div><div class="ttdef"><b>Definition:</b> <a href="File_8cpp_source.html#l00043">File.cpp:43</a></div></div>
<div class="ttc" id="classFileSystem_html_a9d65b54d045d50e0cbd0551000d9d79f"><div class="ttname"><a href="classFileSystem.html#a9d65b54d045d50e0cbd0551000d9d79f">FileSystem::lookupFile</a></div><div class="ttdeci">FileCache * lookupFile(FileSystemPath *path)</div><div class="ttdoc">Retrieve a File from storage. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8cpp_source.html#l00312">FileSystem.cpp:312</a></div></div>
<div class="ttc" id="structFileCache_html"><div class="ttname"><a href="structFileCache.html">FileCache</a></div><div class="ttdoc">Cached in-memory file. </div><div class="ttdef"><b>Definition:</b> <a href="FileCache_8h_source.html#l00035">FileCache.h:35</a></div></div>
<div class="ttc" id="classHashTable_html_a0e5f4164b2a8a70006f92b5edd42098d"><div class="ttname"><a href="classHashTable.html#a0e5f4164b2a8a70006f92b5edd42098d">HashTable::value</a></div><div class="ttdeci">virtual const V value(const K &amp;key, const V defaultValue=V()) const</div><div class="ttdoc">Return the first value for the given key. </div><div class="ttdef"><b>Definition:</b> <a href="HashTable_8h_source.html#l00329">HashTable.h:329</a></div></div>
<div class="ttc" id="unistd_8h_html"><div class="ttname"><a href="unistd_8h.html">unistd.h</a></div></div>
<div class="ttc" id="stdarg_8h_html_aa0628ab596c3d7e78f5e08c2d98e24da"><div class="ttname"><a href="stdarg_8h.html#aa0628ab596c3d7e78f5e08c2d98e24da">va_start</a></div><div class="ttdeci">#define va_start(v, l)</div><div class="ttdef"><b>Definition:</b> <a href="stdarg_8h_source.html#l00050">stdarg.h:50</a></div></div>
<div class="ttc" id="classList_html"><div class="ttname"><a href="classList.html">List</a></div><div class="ttdoc">Simple linked list template class. </div><div class="ttdef"><b>Definition:</b> <a href="List_8h_source.html#l00036">List.h:36</a></div></div>
<div class="ttc" id="structFileSystemMessage_html_a393667a08dfdc40d9f1695e4ecb8aaee"><div class="ttname"><a href="structFileSystemMessage.html#a393667a08dfdc40d9f1695e4ecb8aaee">FileSystemMessage::path</a></div><div class="ttdeci">char * path</div><div class="ttdoc">Path name of the file. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystemMessage_8h_source.html#l00109">FileSystemMessage.h:109</a></div></div>
<div class="ttc" id="classHashTable_html_ac5738483b0125109f24eb6fbf10d4e05"><div class="ttname"><a href="classHashTable.html#ac5738483b0125109f24eb6fbf10d4e05">HashTable::count</a></div><div class="ttdeci">virtual Size count() const</div><div class="ttdoc">Get the number of values stored in the HashTable. </div><div class="ttdef"><b>Definition:</b> <a href="HashTable_8h_source.html#l00215">HashTable.h:215</a></div></div>
<div class="ttc" id="classListIterator_html"><div class="ttname"><a href="classListIterator.html">ListIterator</a></div><div class="ttdoc">Iterate through a List. </div><div class="ttdef"><b>Definition:</b> <a href="ListIterator_8h_source.html#l00037">ListIterator.h:37</a></div></div>
<div class="ttc" id="HashTable_8h_html"><div class="ttname"><a href="HashTable_8h.html">HashTable.h</a></div></div>
<div class="ttc" id="classFileSystemPath_html"><div class="ttname"><a href="classFileSystemPath.html">FileSystemPath</a></div><div class="ttdoc">Simple filesystem path parser. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystemPath_8h_source.html#l00043">FileSystemPath.h:43</a></div></div>
<div class="ttc" id="FileSystem_8h_html"><div class="ttname"><a href="FileSystem_8h.html">FileSystem.h</a></div></div>
<div class="ttc" id="classChannel_html_a384120644263bda09c6b9141a4f45532"><div class="ttname"><a href="classChannel.html#a384120644263bda09c6b9141a4f45532">Channel::write</a></div><div class="ttdeci">virtual Result write(void *buffer)=0</div><div class="ttdoc">Write a message. </div></div>
<div class="ttc" id="classFileSystemPath_html_acf03c28bc958d8329a1e13275f71104e"><div class="ttname"><a href="classFileSystemPath.html#acf03c28bc958d8329a1e13275f71104e">FileSystemPath::split</a></div><div class="ttdeci">List&lt; String * &gt; * split()</div><div class="ttdoc">Returns a List of separate path elements. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystemPath_8cpp_source.html#l00119">FileSystemPath.cpp:119</a></div></div>
<div class="ttc" id="structFileSystemMessage_html_af75d6940638c6388f09dade8d7773b1b"><div class="ttname"><a href="structFileSystemMessage.html#af75d6940638c6388f09dade8d7773b1b">FileSystemMessage::stat</a></div><div class="ttdeci">FileStat * stat</div><div class="ttdoc">File Statistics. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystemMessage_8h_source.html#l00121">FileSystemMessage.h:121</a></div></div>
<div class="ttc" id="classFileSystem_html_a28244f36400696951221689324d4ff26"><div class="ttname"><a href="classFileSystem.html#a28244f36400696951221689324d4ff26">FileSystem::m_requests</a></div><div class="ttdeci">List&lt; FileSystemRequest * &gt; * m_requests</div><div class="ttdoc">Contains ongoing requests. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8h_source.html#l00260">FileSystem.h:260</a></div></div>
<div class="ttc" id="classFileSystem_html_a95e2abd7d58f0dbb6c283616943db22a"><div class="ttname"><a href="classFileSystem.html#a95e2abd7d58f0dbb6c283616943db22a">FileSystem::retryRequests</a></div><div class="ttdeci">virtual bool retryRequests()</div><div class="ttdoc">Retry any pending requests. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8cpp_source.html#l00279">FileSystem.cpp:279</a></div></div>
<div class="ttc" id="group__libposix_html_ga5254bb8024414512a0efe8168b31dda0"><div class="ttname"><a href="group__libposix.html#ga5254bb8024414512a0efe8168b31dda0">close</a></div><div class="ttdeci">int close(int fildes)</div><div class="ttdoc">Close a file descriptor. </div><div class="ttdef"><b>Definition:</b> <a href="close_8cpp_source.html#l00024">close.cpp:24</a></div></div>
<div class="ttc" id="structFileSystemMount_html_ace893c6e5943a4dfdd134bc8d74cd3c0"><div class="ttname"><a href="structFileSystemMount.html#ace893c6e5943a4dfdd134bc8d74cd3c0">FileSystemMount::options</a></div><div class="ttdeci">ulong options</div><div class="ttdoc">Mount options. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystemMount_8h_source.html#l00047">FileSystemMount.h:47</a></div></div>
<div class="ttc" id="group__libposix_html_ga70979f50f9c83e5aebab3d6a1bd4cf35"><div class="ttname"><a href="group__libposix.html#ga70979f50f9c83e5aebab3d6a1bd4cf35">EIO</a></div><div class="ttdeci">#define EIO</div><div class="ttdoc">I/O error. </div><div class="ttdef"><b>Definition:</b> <a href="errno_8h_source.html#l00130">errno.h:130</a></div></div>
<div class="ttc" id="classFileSystem_html_a4875efdffaf91fb7a83d13ea0a57a29a"><div class="ttname"><a href="classFileSystem.html#a4875efdffaf91fb7a83d13ea0a57a29a">FileSystem::FileSystem</a></div><div class="ttdeci">FileSystem(const char *path)</div><div class="ttdoc">Constructor function. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8cpp_source.html#l00028">FileSystem.cpp:28</a></div></div>
<div class="ttc" id="structFileSystemMessage_html_a9e629791993c89e3e60f51fa828424ab"><div class="ttname"><a href="structFileSystemMessage.html#a9e629791993c89e3e60f51fa828424ab">FileSystemMessage::from</a></div><div class="ttdeci">ProcessID from</div><div class="ttdoc">Source of the message. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystemMessage_8h_source.html#l00091">FileSystemMessage.h:91</a></div></div>
<div class="ttc" id="group__libposix_html_gaab5144dac9e072c9873087599a994f5c"><div class="ttname"><a href="group__libposix.html#gaab5144dac9e072c9873087599a994f5c">strerror</a></div><div class="ttdeci">char * strerror(int errnum)</div><div class="ttdoc">The strerror function maps the number in errnum to a message string. </div><div class="ttdef"><b>Definition:</b> <a href="strerror_8cpp_source.html#l00020">strerror.cpp:20</a></div></div>
<div class="ttc" id="classFile_html_a9b56b96a101ef2cd2f1638471868bc94"><div class="ttname"><a href="classFile.html#a9b56b96a101ef2cd2f1638471868bc94">File::read</a></div><div class="ttdeci">virtual Error read(IOBuffer &amp;buffer, Size size, Size offset)</div><div class="ttdoc">Read bytes from the file. </div><div class="ttdef"><b>Definition:</b> <a href="File_8cpp_source.html#l00038">File.cpp:38</a></div></div>
<div class="ttc" id="classDirectory_html_a383e9009e96c4ccc749a3cf149a3491d"><div class="ttname"><a href="classDirectory.html#a383e9009e96c4ccc749a3cf149a3491d">Directory::lookup</a></div><div class="ttdeci">virtual File * lookup(const char *name)</div><div class="ttdoc">Retrieve a File from storage. </div><div class="ttdef"><b>Definition:</b> <a href="Directory_8cpp_source.html#l00053">Directory.cpp:53</a></div></div>
<div class="ttc" id="group__libposix_html_ga7b8e33bf8adf23b27d4f08646c1160a2"><div class="ttname"><a href="group__libposix.html#ga7b8e33bf8adf23b27d4f08646c1160a2">pid_t</a></div><div class="ttdeci">ProcessID pid_t</div><div class="ttdoc">Used for process IDs and process group IDs. </div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00032">types.h:32</a></div></div>
<div class="ttc" id="structFileSystemMessage_html_aae617cddbd9e2b04b093d9f34afc8d22"><div class="ttname"><a href="structFileSystemMessage.html#aae617cddbd9e2b04b093d9f34afc8d22">FileSystemMessage::action</a></div><div class="ttdeci">FileSystemAction action</div><div class="ttdoc">Action to perform. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystemMessage_8h_source.html#l00094">FileSystemMessage.h:94</a></div></div>
<div class="ttc" id="structFileSystemMessage_html_a1fdf74c4cab11a3705fa8a7e75646224"><div class="ttname"><a href="structFileSystemMessage.html#a1fdf74c4cab11a3705fa8a7e75646224">FileSystemMessage::filetype</a></div><div class="ttdeci">FileType filetype</div><div class="ttdoc">Filetype. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystemMessage_8h_source.html#l00115">FileSystemMessage.h:115</a></div></div>
<div class="ttc" id="classAssociative_html_a602e6677bddbe08bfd94663bd215e664"><div class="ttname"><a href="classAssociative.html#a602e6677bddbe08bfd94663bd215e664">Associative::contains</a></div><div class="ttdeci">virtual bool contains(const K &amp;key) const</div><div class="ttdoc">Check if the given key exists. </div><div class="ttdef"><b>Definition:</b> <a href="Associative_8h_source.html#l00111">Associative.h:111</a></div></div>
<div class="ttc" id="structFileSystemMessage_html_ac6b86e3487be471a15a635bc65a2fc5e"><div class="ttname"><a href="structFileSystemMessage.html#ac6b86e3487be471a15a635bc65a2fc5e">FileSystemMessage::size</a></div><div class="ttdeci">Size size</div><div class="ttdoc">Size of the buffer. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystemMessage_8h_source.html#l00103">FileSystemMessage.h:103</a></div></div>
<div class="ttc" id="classHashIterator_html_ae0e2e0d8c2b992aa6734059ac052bb0d"><div class="ttname"><a href="classHashIterator.html#ae0e2e0d8c2b992aa6734059ac052bb0d">HashIterator::hasCurrent</a></div><div class="ttdeci">virtual bool hasCurrent() const</div><div class="ttdoc">Check if there is a current item. </div><div class="ttdef"><b>Definition:</b> <a href="HashIterator_8h_source.html#l00084">HashIterator.h:84</a></div></div>
<div class="ttc" id="classFileSystem_html_ab3b50b840424b97f09c4b852441be98f"><div class="ttname"><a href="classFileSystem.html#ab3b50b840424b97f09c4b852441be98f">FileSystem::m_mountPath</a></div><div class="ttdeci">const char * m_mountPath</div><div class="ttdoc">Mount point. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8h_source.html#l00257">FileSystem.h:257</a></div></div>
<div class="ttc" id="structDeviceID_html"><div class="ttname"><a href="structDeviceID.html">DeviceID</a></div><div class="ttdoc">Describes a device ID number. </div><div class="ttdef"><b>Definition:</b> <a href="Types_8h_source.html#l00145">Types.h:145</a></div></div>
<div class="ttc" id="group__kernelapi_html_ga6233123742aa307f2a5ce737acca67f0"><div class="ttname"><a href="group__kernelapi.html#ga6233123742aa307f2a5ce737acca67f0">SELF</a></div><div class="ttdeci">#define SELF</div><div class="ttdef"><b>Definition:</b> <a href="ProcessID_8h_source.html#l00035">ProcessID.h:35</a></div></div>
<div class="ttc" id="Vector_8h_html"><div class="ttname"><a href="Vector_8h.html">Vector.h</a></div></div>
<div class="ttc" id="classIOBuffer_html_a4d385a70c5fd475cf36709f9432fcd8c"><div class="ttname"><a href="classIOBuffer.html#a4d385a70c5fd475cf36709f9432fcd8c">IOBuffer::getCount</a></div><div class="ttdeci">Size getCount() const</div><div class="ttdoc">Get byte count. </div><div class="ttdef"><b>Definition:</b> <a href="IOBuffer_8cpp_source.html#l00038">IOBuffer.cpp:38</a></div></div>
<div class="ttc" id="group__kernelapi_html_ggad194eea1ab5db1371e5da2cc4f256a82add0563c60538360bb6cf3df3d39e7ab4"><div class="ttname"><a href="group__kernelapi.html#ggad194eea1ab5db1371e5da2cc4f256a82add0563c60538360bb6cf3df3d39e7ab4">GetPID</a></div><div class="ttdef"><b>Definition:</b> <a href="ProcessCtl_8h_source.html#l00042">ProcessCtl.h:42</a></div></div>
<div class="ttc" id="structFileSystemMount_html_acabcaf5283b5928360f2a88b28bc1b91"><div class="ttname"><a href="structFileSystemMount.html#acabcaf5283b5928360f2a88b28bc1b91">FileSystemMount::procID</a></div><div class="ttdeci">ProcessID procID</div><div class="ttdoc">Server which is responsible for the mount. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystemMount_8h_source.html#l00044">FileSystemMount.h:44</a></div></div>
<div class="ttc" id="group__libfs_html_ga306ffcae7edd4e8e4f5779ad8359ee1c"><div class="ttname"><a href="group__libfs.html#ga306ffcae7edd4e8e4f5779ad8359ee1c">PATHLEN</a></div><div class="ttdeci">#define PATHLEN</div><div class="ttdoc">Maximum length of a filesystem path. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystemPath_8h_source.html#l00035">FileSystemPath.h:35</a></div></div>
<div class="ttc" id="group__libposix_html_gaa0f602f3fd369a6fede82190710b9c5c"><div class="ttname"><a href="group__libposix.html#gaa0f602f3fd369a6fede82190710b9c5c">ENOTEMPTY</a></div><div class="ttdeci">#define ENOTEMPTY</div><div class="ttdoc">Directory not empty. </div><div class="ttdef"><b>Definition:</b> <a href="errno_8h_source.html#l00217">errno.h:217</a></div></div>
<div class="ttc" id="classFileSystemPath_html_ad3a2d1bf0f25a1f9681694b48d87d991"><div class="ttname"><a href="classFileSystemPath.html#ad3a2d1bf0f25a1f9681694b48d87d991">FileSystemPath::length</a></div><div class="ttdeci">Size length() const</div><div class="ttdoc">Get Length of our full path. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystemPath_8cpp_source.html#l00124">FileSystemPath.cpp:124</a></div></div>
<div class="ttc" id="classListIterator_html_a6750d850524a46222fff4d24d1479f4c"><div class="ttname"><a href="classListIterator.html#a6750d850524a46222fff4d24d1479f4c">ListIterator::hasCurrent</a></div><div class="ttdeci">virtual bool hasCurrent() const</div><div class="ttdoc">Check if there is a current item on the List. </div><div class="ttdef"><b>Definition:</b> <a href="ListIterator_8h_source.html#l00108">ListIterator.h:108</a></div></div>
<div class="ttc" id="classFileSystem_html_a824d536860a0deb5be9ee61334105b40"><div class="ttname"><a href="classFileSystem.html#a824d536860a0deb5be9ee61334105b40">FileSystem::processRequest</a></div><div class="ttdeci">Error processRequest(FileSystemRequest *req)</div><div class="ttdoc">Process a FileSystemRequest. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8cpp_source.html#l00147">FileSystem.cpp:147</a></div></div>
<div class="ttc" id="HashIterator_8h_html"><div class="ttname"><a href="HashIterator_8h.html">HashIterator.h</a></div></div>
<div class="ttc" id="group__libfs_html_gga48a52b001384d627326e5728208bbf96a57479680371066393b8b4fdd05ab5600"><div class="ttname"><a href="group__libfs.html#gga48a52b001384d627326e5728208bbf96a57479680371066393b8b4fdd05ab5600">DeleteFile</a></div><div class="ttdef"><b>Definition:</b> <a href="FileSystemMessage_8h_source.html#l00045">FileSystemMessage.h:45</a></div></div>
<div class="ttc" id="group__libstd_html_gac328e551bde3d39b6d7b8cc9e048d941"><div class="ttname"><a href="group__libstd.html#gac328e551bde3d39b6d7b8cc9e048d941">ZERO</a></div><div class="ttdeci">#define ZERO</div><div class="ttdoc">Zero value. </div><div class="ttdef"><b>Definition:</b> <a href="Macros_8h_source.html#l00043">Macros.h:43</a></div></div>
<div class="ttc" id="classFileSystem_html_af4d56f27e3048e630b4cdf9f9cd46fcf"><div class="ttname"><a href="classFileSystem.html#af4d56f27e3048e630b4cdf9f9cd46fcf">FileSystem::pathHandler</a></div><div class="ttdeci">void pathHandler(FileSystemMessage *msg)</div><div class="ttdoc">Process an incoming filesystem request using a path. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8cpp_source.html#l00135">FileSystem.cpp:135</a></div></div>
<div class="ttc" id="classFileSystem_html_a8b2ba788f5a62495fa62a2576f49c821"><div class="ttname"><a href="classFileSystem.html#a8b2ba788f5a62495fa62a2576f49c821">FileSystem::findFileCache</a></div><div class="ttdeci">FileCache * findFileCache(char *path)</div><div class="ttdoc">Search the cache for an entry. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8cpp_source.html#l00389">FileSystem.cpp:389</a></div></div>
<div class="ttc" id="group__libfs_html_gga48a52b001384d627326e5728208bbf96a663d39e7eb1c3642d09be4dc5702e192"><div class="ttname"><a href="group__libfs.html#gga48a52b001384d627326e5728208bbf96a663d39e7eb1c3642d09be4dc5702e192">CreateFile</a></div><div class="ttdef"><b>Definition:</b> <a href="FileSystemMessage_8h_source.html#l00041">FileSystemMessage.h:41</a></div></div>
<div class="ttc" id="structFileSystemMount_html"><div class="ttname"><a href="structFileSystemMount.html">FileSystemMount</a></div><div class="ttdoc">Represents a mounted filesystem. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystemMount_8h_source.html#l00038">FileSystemMount.h:38</a></div></div>
<div class="ttc" id="group__libposix_html_ga03e689f378f643d16ea7537918528a48"><div class="ttname"><a href="group__libposix.html#ga03e689f378f643d16ea7537918528a48">ENOENT</a></div><div class="ttdeci">#define ENOENT</div><div class="ttdoc">No such file or directory. </div><div class="ttdef"><b>Definition:</b> <a href="errno_8h_source.html#l00178">errno.h:178</a></div></div>
<div class="ttc" id="classFileSystemPath_html_a16ee8c766b058b1c398beb02edb4caeb"><div class="ttname"><a href="classFileSystemPath.html#a16ee8c766b058b1c398beb02edb4caeb">FileSystemPath::full</a></div><div class="ttdeci">String * full() const</div><div class="ttdoc">Get the full path as a String instance. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystemPath_8cpp_source.html#l00114">FileSystemPath.cpp:114</a></div></div>
<div class="ttc" id="structFileSystemMessage_html_af9da636fc5900a76d9b553bf3bbffb0a"><div class="ttname"><a href="structFileSystemMessage.html#af9da636fc5900a76d9b553bf3bbffb0a">FileSystemMessage::deviceID</a></div><div class="ttdeci">DeviceID deviceID</div><div class="ttdoc">Device major/minor numbers. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystemMessage_8h_source.html#l00124">FileSystemMessage.h:124</a></div></div>
<div class="ttc" id="structFileCache_html_ae49028ad84ac22d14f2395c4cd8da174"><div class="ttname"><a href="structFileCache.html#ae49028ad84ac22d14f2395c4cd8da174">FileCache::parent</a></div><div class="ttdeci">FileCache * parent</div><div class="ttdoc">Parent. </div><div class="ttdef"><b>Definition:</b> <a href="FileCache_8h_source.html#l00080">FileCache.h:80</a></div></div>
<div class="ttc" id="group__libfs_html_gga48a52b001384d627326e5728208bbf96a9980b102b1318893a80e5095fa02668c"><div class="ttname"><a href="group__libfs.html#gga48a52b001384d627326e5728208bbf96a9980b102b1318893a80e5095fa02668c">ReadFile</a></div><div class="ttdef"><b>Definition:</b> <a href="FileSystemMessage_8h_source.html#l00042">FileSystemMessage.h:42</a></div></div>
<div class="ttc" id="classFile_html_aeeb18ed1a35f572f93d337ccb842e5fe"><div class="ttname"><a href="classFile.html#aeeb18ed1a35f572f93d337ccb842e5fe">File::getType</a></div><div class="ttdeci">FileType getType() const</div><div class="ttdoc">Retrieve our filetype. </div><div class="ttdef"><b>Definition:</b> <a href="File_8cpp_source.html#l00033">File.cpp:33</a></div></div>
<div class="ttc" id="structFileSystemMessage_html_ab85f29e74ab62487111284ad0a069192"><div class="ttname"><a href="structFileSystemMessage.html#ab85f29e74ab62487111284ad0a069192">FileSystemMessage::result</a></div><div class="ttdeci">Error result</div><div class="ttdoc">Result code. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystemMessage_8h_source.html#l00097">FileSystemMessage.h:97</a></div></div>
<div class="ttc" id="classFileSystem_html_a5fa50bab1ae9956dffcb6c92c0fbfd61"><div class="ttname"><a href="classFileSystem.html#a5fa50bab1ae9956dffcb6c92c0fbfd61">FileSystem::insertFileCache</a></div><div class="ttdeci">FileCache * insertFileCache(File *file, const char *pathFormat,...)</div><div class="ttdoc">Inserts a file into the in-memory filesystem tree. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8cpp_source.html#l00353">FileSystem.cpp:353</a></div></div>
<div class="ttc" id="classChannelMessage_html_af8387313dcfe16279396f01cfcfc82f4"><div class="ttname"><a href="classChannelMessage.html#af8387313dcfe16279396f01cfcfc82f4">ChannelMessage::type</a></div><div class="ttdeci">Type type</div><div class="ttdoc">Message type is either a request or response. </div><div class="ttdef"><b>Definition:</b> <a href="ChannelMessage_8h_source.html#l00048">ChannelMessage.h:48</a></div></div>
<div class="ttc" id="classFileSystem_html_a78fa1c928f212f49b840c75f6d119ae0"><div class="ttname"><a href="classFileSystem.html#a78fa1c928f212f49b840c75f6d119ae0">FileSystem::clearFileCache</a></div><div class="ttdeci">void clearFileCache(FileCache *cache=ZERO)</div><div class="ttdoc">Cleans up the entire file cache (except opened file caches and root). </div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8cpp_source.html#l00432">FileSystem.cpp:432</a></div></div>
<div class="ttc" id="classFileSystem_html_a7c8b7ae0ac61411fb82f17d132fc0e36"><div class="ttname"><a href="classFileSystem.html#a7c8b7ae0ac61411fb82f17d132fc0e36">FileSystem::createFile</a></div><div class="ttdeci">virtual File * createFile(FileType type, DeviceID deviceID)</div><div class="ttdoc">Create a new file. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8cpp_source.html#l00097">FileSystem.cpp:97</a></div></div>
<div class="ttc" id="classFileSystem_html_a0cec61006e34d87dce991d0b352001de"><div class="ttname"><a href="classFileSystem.html#a0cec61006e34d87dce991d0b352001de">FileSystem::cacheHit</a></div><div class="ttdeci">virtual FileCache * cacheHit(FileCache *cache)</div><div class="ttdoc">Process a cache hit. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8cpp_source.html#l00427">FileSystem.cpp:427</a></div></div>
<div class="ttc" id="group__libstd_html_gaecc1f7a8a2493b9e021e5bff76a00a5b"><div class="ttname"><a href="group__libstd.html#gaecc1f7a8a2493b9e021e5bff76a00a5b">DEBUG</a></div><div class="ttdeci">#define DEBUG(msg)</div><div class="ttdoc">Output a debug message to standard output. </div><div class="ttdef"><b>Definition:</b> <a href="Log_8h_source.html#l00086">Log.h:86</a></div></div>
<div class="ttc" id="group__libposix_html_ga0a3bef9e5c47e42917692b5dae3b5498"><div class="ttname"><a href="group__libposix.html#ga0a3bef9e5c47e42917692b5dae3b5498">EEXIST</a></div><div class="ttdeci">#define EEXIST</div><div class="ttdoc">File exists. </div><div class="ttdef"><b>Definition:</b> <a href="errno_8h_source.html#l00103">errno.h:103</a></div></div>
<div class="ttc" id="classFile_html"><div class="ttname"><a href="classFile.html">File</a></div><div class="ttdoc">Represents a file present on a FileSystem. </div><div class="ttdef"><b>Definition:</b> <a href="File_8h_source.html#l00043">File.h:43</a></div></div>
<div class="ttc" id="classChannelServer_html_a8ca0774f62c838d5eda9d098dceac0e2"><div class="ttname"><a href="classChannelServer.html#a8ca0774f62c838d5eda9d098dceac0e2">ChannelServer&lt; FileSystem, FileSystemMessage &gt;::m_registry</a></div><div class="ttdeci">ChannelRegistry * m_registry</div><div class="ttdoc">Contains registered channels. </div><div class="ttdef"><b>Definition:</b> <a href="ChannelServer_8h_source.html#l00404">ChannelServer.h:404</a></div></div>
<div class="ttc" id="group__kernelapi_html_ga12fbd36d91338390f4a6742d5014549b"><div class="ttname"><a href="group__kernelapi.html#ga12fbd36d91338390f4a6742d5014549b">ProcessCtl</a></div><div class="ttdeci">API::Result ProcessCtl(ProcessID proc, ProcessOperation op, Address addr=0, Address output=0)</div><div class="ttdoc">Prototype for user applications. </div><div class="ttdef"><b>Definition:</b> <a href="ProcessCtl_8h_source.html#l00097">ProcessCtl.h:97</a></div></div>
<div class="ttc" id="classFileSystem_html_ab61f284c8936ac995fc3657370f4d6be"><div class="ttname"><a href="classFileSystem.html#ab61f284c8936ac995fc3657370f4d6be">FileSystem::timeout</a></div><div class="ttdeci">virtual void timeout()</div><div class="ttdoc">Called when a sleep timeout is expired. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8cpp_source.html#l00272">FileSystem.cpp:272</a></div></div>
<div class="ttc" id="structFileSystemMessage_html"><div class="ttname"><a href="structFileSystemMessage.html">FileSystemMessage</a></div><div class="ttdoc">FileSystem IPC message. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystemMessage_8h_source.html#l00052">FileSystemMessage.h:52</a></div></div>
<div class="ttc" id="classChannelRegistry_html_ac2aed673427aec587152e2e50445c2f1"><div class="ttname"><a href="classChannelRegistry.html#ac2aed673427aec587152e2e50445c2f1">ChannelRegistry::getProducer</a></div><div class="ttdeci">Channel * getProducer(ProcessID pid)</div><div class="ttdoc">Get one producer. </div><div class="ttdef"><b>Definition:</b> <a href="ChannelRegistry_8cpp_source.html#l00038">ChannelRegistry.cpp:38</a></div></div>
<div class="ttc" id="group__libfs_html_gga48a52b001384d627326e5728208bbf96ac6e76230ddc02752cf04f3505f60a387"><div class="ttname"><a href="group__libfs.html#gga48a52b001384d627326e5728208bbf96ac6e76230ddc02752cf04f3505f60a387">StatFile</a></div><div class="ttdef"><b>Definition:</b> <a href="FileSystemMessage_8h_source.html#l00044">FileSystemMessage.h:44</a></div></div>
<div class="ttc" id="classFileSystem_html_a334300c3435c6ddd0053ee653a5446ae"><div class="ttname"><a href="classFileSystem.html#a334300c3435c6ddd0053ee653a5446ae">FileSystem::registerFile</a></div><div class="ttdeci">Error registerFile(File *file, const char *path,...)</div><div class="ttdoc">Register a new File. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8cpp_source.html#l00102">FileSystem.cpp:102</a></div></div>
<div class="ttc" id="classFileSystem_html_a872b5c352670f94ad02984882b436ec2"><div class="ttname"><a href="classFileSystem.html#a872b5c352670f94ad02984882b436ec2">FileSystem::getRoot</a></div><div class="ttdeci">Directory * getRoot()</div><div class="ttdoc">Get root directory. </div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8cpp_source.html#l00055">FileSystem.cpp:55</a></div></div>
<div class="ttc" id="group__libposix_html_ga072ac10bfd51fd99aeb5a9ef1b286ee0"><div class="ttname"><a href="group__libposix.html#ga072ac10bfd51fd99aeb5a9ef1b286ee0">strlcpy</a></div><div class="ttdeci">size_t strlcpy(char *dst, const char *src, size_t siz)</div><div class="ttdoc">Copy src to string dst of size siz. </div><div class="ttdef"><b>Definition:</b> <a href="strlcpy_8cpp_source.html#l00019">strlcpy.cpp:19</a></div></div>
<div class="ttc" id="group__libstd_html_ga32561b1ad57f66e2ca93b07d45e9a9ee"><div class="ttname"><a href="group__libstd.html#ga32561b1ad57f66e2ca93b07d45e9a9ee">Error</a></div><div class="ttdeci">slong Error</div><div class="ttdoc">Error code defined in Error.h. </div><div class="ttdef"><b>Definition:</b> <a href="Types_8h_source.html#l00159">Types.h:159</a></div></div>
<div class="ttc" id="classFile_html_a44dfeceb2c3638b948aa5a7decb1a419"><div class="ttname"><a href="classFile.html#a44dfeceb2c3638b948aa5a7decb1a419">File::status</a></div><div class="ttdeci">virtual Error status(FileSystemMessage *msg)</div><div class="ttdoc">Retrieve file statistics. </div><div class="ttdef"><b>Definition:</b> <a href="File_8cpp_source.html#l00048">File.cpp:48</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
